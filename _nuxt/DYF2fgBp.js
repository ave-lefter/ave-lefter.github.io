import{f as e,v as t,P as n,g as a,c as o,o as i,a as s,b as l,J as r,i as u,t as c,C as m,w as d,F as p,D as f,K as v,s as k,_,B as b,$ as g,cv as h,a4 as y,H as x,d as w,by as T,nR as S,E as $,b3 as N,bp as I,R as M,oH as P,nT as A,bN as F,oI as C,oJ as L,oK as H,oL as E,oM as R,oN as U,oO as O,oP as j,oQ as D,o8 as B,o7 as V,oR as z,oS as K,oT as W,oU as G,oV as q,bg as Y,oW as J,oX as Q,oY as Z,a0 as X,oZ as ee,o_ as te,nb as ne,o$ as ae,p0 as oe,p1 as ie,p2 as se,p3 as le,p4 as re,p5 as ue,O as ce,M as me,z as de,r as pe,aH as fe,fr as ve,a8 as ke,p6 as _e,a3 as be,aM as ge,aN as he,aT as ye,a2 as xe,fm as we,bO as Te,fj as Se,aI as $e,aJ as Ne,m as Ie,n as Me,cA as Pe,U as Ae,N as Fe,fe as Ce,fg as Le,Q as He,p7 as Ee,bh as Re,G as Ue,nY as Oe,cz as je,cB as De,bS as Be,o9 as Ve,p8 as ze,p9 as Ke,pa as We,pb as Ge}from"#entry";import{u as qe,S as Ye,P as Je,a as Qe}from"./BCQj4c_9.js";import{E as Ze,a as Xe}from"./DMZvEsQv.js";import"./Div4Sb7D.js";import"./1bXUUYzG.js";import{_ as et}from"./NZiWsxCB.js";import{E as tt}from"./DWsaYBFQ.js";import{a as nt}from"./BUyr3k23.js";import"./vIWCTboT.js";import"./BbcemesW.js";import"./EyvYgUJ0.js";import"./DZrW0QoB.js";import"./CZIhrSUn.js";import"./DhoqPgLY.js";import"./DYraDxUd.js";import"./C7V9UFRI.js";import"./4ZxzSbBH.js";const at={class:"relative"},ot=_(e({__name:"solanaLimitExpired",props:{expiredTime:{type:[Number,null],default:null}},emits:["update:visible","update:expiredTime"],setup(e,{emit:_}){const{t:b}=t(),g=e,h=_,y=n("selectRef"),x=a(()=>[{name:b("never"),value:""},{name:b("10min"),value:600},{name:b("1h"),value:3600},{name:b("1d"),value:86400},{name:b("3d"),value:259200},{name:b("7d"),value:604800}].map(e=>e.value===g.expiredTime?{...e,color:"#286DFF "}:e)),w=a(()=>x.value.find(e=>e.value===(null===g.expiredTime?"":g.expiredTime))?.name),T=a({get:()=>null===g.expiredTime?"":g.expiredTime,set(e){h("update:expiredTime",""===e?null:e)}});return(e,t)=>{const n=m,a=Ze,_=Xe;return i(),o("div",at,[s("div",{class:"select-container clickable",onClick:t[0]||(t[0]=r(e=>u(y)?.focus?.(),["stop"]))},[s("span",null,c(u(w)),1),l(n,{class:"clickable text-12px color-#999 ml-5px",name:"solar:alt-arrow-down-bold"})]),l(_,{ref_key:"selectRef",ref:y,modelValue:u(T),"onUpdate:modelValue":t[1]||(t[1]=e=>k(T)?T.value=e:null),placeholder:"Select",size:"small",style:{width:"80px",opacity:"0",position:"absolute",right:"0",top:"50%",transform:"translateY(-50%)"}},{default:d(()=>[(i(!0),o(p,null,f(u(x),e=>(i(),v(a,{key:e.value,label:e.name,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-775d3efa"]]),it={key:0},st={key:1},lt={key:1},rt={key:2},ut={class:"swap-info"},ct={key:0,class:"swap-info_item"},mt={class:"swap-info_item-label"},dt=["innerHTML"],pt={class:"swap-info_item"},ft={class:"swap-info_item-label"},vt={class:"swap-info_item-value"},kt=["src"],_t=["innerHTML"],bt={class:"ml-5px"},gt={class:"swap-info_item"},ht={class:"swap-info_item-label"},yt={class:"swap-info_item-value"},xt=["innerHTML"],wt={style:{color:"var(--custom-primary-color)"}},Tt={class:"swap-info_item"},St={class:"swap-info_item-label"},$t={class:"swap-info_item-value"},Nt=["src"],It=["innerHTML"],Mt={class:"ml-5px"},Pt={class:"swap-info_item"},At={class:"swap-info_item-label"},Ft={class:"swap-info_item-value"},Ct=["src"],Lt=["innerHTML"],Ht={class:"ml-5"},Et={class:"swap-info_item"},Rt={class:"swap-info_item-label"},Ut={class:"swap-info_item-value"},Ot=["innerHTML"],jt={style:{color:"var(--custom-primary-color)"}},Dt={class:"swap-info_item"},Bt={class:"swap-info_item-label"},Vt={class:"swap-info_item-value"},zt=["src"],Kt=["innerHTML"],Wt={class:"ml-5"},Gt={key:3,class:"swap-info_item"},qt={class:"swap-info_item-label"},Yt=["innerHTML"],Jt={class:"swap-info_item tips warning"},Qt={class:"swap-info_item tips warning"},Zt={key:0,class:"swap-info_item tips warning"},Xt={key:1,class:"swap-info_item tips warning"},en={key:1,class:"swap-info center"},tn={class:"mt-20"},nn={class:"swap-info center"},an={class:"mt-20px"},on={class:"footer"},sn=_(e({__name:"confirmLimit",props:{visible:{type:Boolean,default:!1},limitInfo:{type:Object,default:()=>{}},loading:{type:Boolean,default:!1},chain:{type:String,default:""},limitGasU:{type:String,default:""},activeShow:{type:Number,default:0}},emits:["update:visible","submit"],setup(e,{emit:t}){const n=e,f=t,_=a({get:()=>n.visible,set(e){f("update:visible",e)}});function M(e){return e.logoURI&&!e?.logoURI?.includes("empty-token")?e.logoURI:N({symbol:e?.symbol,chain:e?.chain,logo_url:e?.logo_url})}function P(){window.open(I(n.chain,n.limitInfo.transaction,"tx"))}return(t,n)=>{const a=x,N=T,I=m,A=$;return i(),v(A,{modelValue:u(_),"onUpdate:modelValue":n[1]||(n[1]=e=>k(_)?_.value=e:null),width:"446px"},{header:d(()=>[1===e.activeShow?(i(),o(p,{key:0},[0===e.limitInfo.orderType?(i(),o("span",it,c(0===e.limitInfo.activeTab?t.$t("limitBuy"):t.$t("limitSell")),1)):b("",!0),1===e.limitInfo.orderType?(i(),o("span",st,c(0===e.limitInfo.activeTab?t.$t("stopLimitBuy"):t.$t("stopLimitSell")),1)):b("",!0)],64)):2===e.activeShow?(i(),o("span",lt,c(t.$t("waitForConfirming")),1)):3===e.activeShow?(i(),o("span",rt,c(t.$t("tradeConfirmed")),1)):b("",!0)]),default:d(()=>[1==e.activeShow?(i(),o(p,{key:0},[s("ul",ut,[1===e.limitInfo.orderType?(i(),o("li",ct,[s("div",mt,c(t.$t("limitEffective")),1),s("div",{class:"swap-info_item-value",innerHTML:t.$t("triggerPriceEffective",{symbol:1===e.limitInfo.activeTab?e.limitInfo?.fromToken?.symbol||"":e.limitInfo?.toToken?.symbol||"",price:("formatNumber"in t?t.formatNumber:u(g))(e.limitInfo?.triggerPrice||0)})},null,8,dt)])):b("",!0),0===e.limitInfo.activeTab?(i(),o(p,{key:1},[s("li",pt,[s("div",ft,c(t.$t("limitBuy")),1),s("div",vt,[s("img",{class:"icon-token",src:M(e.limitInfo.toToken),alt:"",height:"20"},null,8,kt),s("span",{innerHTML:("formatNumber"in t?t.formatNumber:u(g))(e.limitInfo.toAmount||0)},null,8,_t),s("span",bt,c(e.limitInfo?.toToken?.symbol||""),1)])]),s("li",gt,[s("div",ht,c(t.$t("limitPrice"))+"("+c(1===e.limitInfo.activeTab?e.limitInfo?.fromToken?.symbol||"":e.limitInfo?.toToken?.symbol||"")+")",1),s("div",yt,[s("span",{innerHTML:`$${("formatNumber"in t?t.formatNumber:u(g))(e.limitInfo.targetLimitPrice||0)}`},null,8,xt),s("span",wt,"("+c(t.$t("auto-submitWhenPriceBuy"))+")",1)])]),s("li",Tt,[s("div",St,c(t.$t("expectedPayment")),1),s("div",$t,[s("img",{class:"icon-token",src:M(e.limitInfo.fromToken),alt:"",height:"20"},null,8,Nt),s("span",{innerHTML:("formatNumber"in t?t.formatNumber:u(g))(e.limitInfo.fromAmount||0)},null,8,It),s("span",Mt,c(e.limitInfo?.fromToken?.symbol||""),1)])])],64)):b("",!0),1===e.limitInfo.activeTab?(i(),o(p,{key:2},[s("li",Pt,[s("div",At,c(t.$t("limitSell")),1),s("div",Ft,[s("img",{class:"icon-token",src:M(e.limitInfo.fromToken),alt:"",height:"20"},null,8,Ct),s("span",{innerHTML:("formatNumber"in t?t.formatNumber:u(g))(e.limitInfo.fromAmount||0)},null,8,Lt),s("span",Ht,c(e.limitInfo?.fromToken?.symbol||""),1)])]),s("li",Et,[s("div",Rt,c(t.$t("limitPrice"))+"("+c(1===e.limitInfo.activeTab?e.limitInfo?.fromToken?.symbol||"":e.limitInfo?.toToken?.symbol||"")+")",1),s("div",Ut,[s("span",{innerHTML:`$${("formatNumber"in t?t.formatNumber:u(g))(e.limitInfo.targetLimitPrice||0)}`},null,8,Ot),s("span",jt,"("+c(t.$t("auto-submitWhenPriceSell"))+")",1)])]),s("li",Dt,[s("div",Bt,c(t.$t("expectedReceivable")),1),s("div",Vt,[s("img",{class:"icon-token",src:M(e.limitInfo.toToken),alt:"",height:"20"},null,8,zt),s("span",{innerHTML:("formatNumber"in t?t.formatNumber:u(g))(e.limitInfo.toAmount||0)},null,8,Kt),s("span",Wt,c(e.limitInfo?.toToken?.symbol||""),1)])])],64)):b("",!0),"solana"!==e.chain?(i(),o("li",Gt,[s("div",qt,c(t.$t("estimateGas")),1),s("div",{class:"swap-info_item-value",style:{"text-align":"right"},innerHTML:t.$t("estimateGasTips",{n:("formatNumber"in t?t.formatNumber:u(g))(e.limitGasU??1,1)})},null,8,Yt)])):b("",!0),"solana"!==e.chain?(i(),o(p,{key:4},[s("li",Jt,"* "+c(t.$t("limitFeeTip")),1),s("li",Qt,"* "+c(t.$t("limitTokenTips")),1),e.limitInfo?.fromToken?.address===u(h)?(i(),o("li",Zt,c(t.$t("limitTips1")),1)):(i(),o("li",Xt,c(t.$t("limitTips2")),1))],64)):b("",!0)]),s("div",{class:"footer",style:y({"padding-bottom":"solana"!==e.chain?"10px":"0"})},[l(a,{class:"swap-button w-full",type:"primary",size:"large",loading:e.loading,"loading-text":t.$t("confirming"),block:"",onClick:n[0]||(n[0]=r(e=>f("submit"),["stop"]))},{default:d(()=>[w(c(t.$t("confirm")),1)]),_:1},8,["loading","loading-text"])],4)],64)):2==e.activeShow?(i(),o("div",en,[l(N,{size:110,color:"#747782",style:{animation:"rotating 2s linear infinite normal"}},{default:d(()=>[l(u(S))]),_:1}),s("span",tn,c(t.$t("plsConfirmWallet")),1)])):3==e.activeShow?(i(),o(p,{key:2},[s("div",nn,[l(I,{name:"lineicons:arrow-up-circle",class:"text-110px"}),s("span",an,c(t.$t("plsViewBlockChainExplorer")),1)]),s("div",on,[l(a,{class:"swap-button w-full",type:"primary",size:"large",block:"",onClick:r(P,["stop"])},{default:d(()=>[w(c(t.$t("viewTransition")),1)]),_:1})])],64)):b("",!0)]),_:1},8,["modelValue"])}}}),[["__scopeId","data-v-2d2e0786"]]);async function ln(e){const{from_token:t,to_token:n,amountIn:a,amountOut:o}=e,i=await function(e){let t="Lifinity V1,Lifinity V2,Phoenix,Openbook,OpenBook V2";sessionStorage.isMoonshot||sessionStorage.isMeteora||(t+=",Meteora,Meteora DLMM");const n={...e,restrictIntermediateTokens:!0,excludeDexes:t};n.inputMint===h&&(n.inputMint="So11111111111111111111111111111111111111112");n.outputMint===h&&(n.outputMint="So11111111111111111111111111111111111111112");return J({method:"get",url:"https://api.jup.ag/swap/v1/quote",params:n},"v3")}({inputMint:t,outputMint:n,amount:a||o||"",slippageBps:200,swapMode:a?"ExactIn":"ExactOut"});return{...i,chain:"solana"}}function rn(e,{chain:t,QuoteContract:n,swapContract:a,gasPrice:o,nativePrice:i,amountIn:s,amountOut:l,balance:r,allowanceAmount:u,fromIsETH:c,toIsETH:m,mainName:d,from_token:p,to_token:f}){let v="0";if(!e.pair_path||0===e.pair_path?.length||!e.token_path||0===e.token_path.length)return Promise.resolve({routerPath:[],routerPairPath:[]});const k=e.pair_path.map(e=>Q?.includes(t)?{pair:"v4"===e.protocol?"0x".padEnd(42,"0"):e.pair,tokenIn:e.token_in,tokenOut:e.token_out,router:e.amm_router,poolId:"v4"===e.protocol?e.pair:"0x".padEnd(66,"0")}:{pair:e.pair,tokenIn:e.token_in,tokenOut:e.token_out,router:e.amm_router});let _=1;"arbitrum"===t?_=3.5:("optimism"===t||"base"===t)&&(_=4);const b=M();return Number(s)?n.getAmountsOut.staticCall(k,s).then(async n=>{let l=e.token_path.map((e,t)=>({...e,amount:n[t].toString()}));c&&(l[0].isETH=c,l[0].symbol=d),m&&(l[l.length-1].isETH=m,l[l.length-1].symbol=d);let g=0;if(u.gte(s)&&r.gte(s)){const r=b.address,u=String(e.feeIn??"2"),c=30,m=Z(b.address);let d={srcToken:p,dstToken:f,srcReceiver:0!==Number(k[0].router)?e.pair_path[0].pair:a.address,dstReceiver:r,amount:s,minReturnAmount:"1",feeIn:u,feeRate:c,feeTo:Z(b.address),receiveRate:0,referrer:m,path:k,routerPath:[]};Q?.includes(t)&&(d={srcToken:p,dstToken:f,amount:s,minReturnAmount:"1",feeIn:u,feeRate:c,feeTo:Z(b.address),minLiquidity:"0",maxLiquidity:"0",referRates:[0],referrers:[m],paths:k});const x=p===h?s:"0",w=n?.[l.length-1];try{const n=new X(await(a?.[ee(t)]?.staticCall(d,{value:x})));g=Number(((1e4-n.times(1e4).div(w).toNumber()-c)/100).toFixed(2))||0,g>0&&(l[l.length-1].amount=n.toString()),(e.total_sell_tax||0)>0&&(_=2,"arbitrum"===t?_=4:"eth"===t?_=2.3:("optimism"===t||"base"===t)&&(_=4.5));const s=new X("360000"),r=l[l.length-1]?.decimals,u=new X(i.toString()),m=new X(e.to_price.toString()),p=new X(o.toString()).times(u).times(s.toString()).times(_).div(m).times(10**(r-18)).toFixed(0);v=new X(o.toString()).times(u).times(s.toString()).times(_).div(10**18).toFixed(),p&&(l[l.length-1].amount=n.minus(p).toString())}catch(y){}}else{g=new X(e.total_buy_tax||0).plus(e.total_sell_tax||0)||new X(0);let t=new X("360000");(e.total_sell_tax||0)>0?t=t.times(2):g.gt(0)&&(t=t.times(1.5));const a=n?.[l.length-1],s=new X(e.to_price.toString()),r=l[l.length-1]?.decimals,u=new X(i.toString()),c=new X(o.toString()).times(u).times(t.toString()).div(s).times(10**(r-18)).toFixed(0);let m=new X(a.toString()).times(new X(100).minus(g)).div(100);m.gt(c)&&(m=m.minus(c)),v=new X(o.toString()).times(u).times(t.toString()).times(_).div(10**18).toFixed(),l[l.length-1].amount=m.toFixed(0)}return l=l.map(e=>({...e,address:e.isETH?h:e.address})),l[0].price=e.from_price,l[l.length-1].price=e.to_price,{routerPath:l,routerPairPath:k,...e,totalTax:Math.max(Number(g.toFixed()),0),isAmountOut:!1,gas:"0".toString(),gasU:v}}):l?n.getAmountsIn.staticCall(k,l).then(async n=>{let s=e.token_path.map((e,t)=>({...e,amount:n[t].toString()}));c&&(s[0].isETH=c,s[0].symbol=d),m&&(s[s.length-1].isETH=m,s[s.length-1].symbol=d);const g=n?.[0];let y=0;if(u.gte(g)&&r.gte(g)){const n=b.address,u=String(e.feeIn??"2"),c=30,m=Z(b.address),d=0,w={srcToken:p,dstToken:f,srcReceiver:0!==Number(k[0].router)?e.pair_path[0].pair:a.address,dstReceiver:n,amount:r.toString(),minReturnAmount:l,feeIn:u,feeRate:c,feeTo:m,receiveRate:ue.test(t)?d:0,referrer:m,path:k,routerPath:[]},T=p===h?w.amount:"0";try{const n=new X(await a.exactOutput.staticCall(w,{value:T}));y=Number(((1e4-g.times(1e4).div(n).toNumber()-c)/100).toFixed(2))||0,y>0&&(s[0].amount=n.toString()),(e.total_sell_tax||0)>0&&(_=2,"arbitrum"===t?_=4:"eth"===t?_=2.3:"optimism"===t?_=4.5:"base"===t&&(_=5));const l=new X("360000"),r=s[0]?.decimals,u=new X(i.toString()),m=new X(e.from_price.toString()),d=new X(o.toString()).times(u).times(l.toString()).times(_).div(m).times(10**(r-18)).toFixed(0);v=new X(o.toString()).times(u).times(l.toString()).times(_).div(10**18).toFixed(),d&&(s[0].amount=n.plus(d).toString())}catch(x){}}else{y=new X(e.total_buy_tax||0).plus(e.total_sell_tax||0)||new X(0);let a=new X("360000");(e.total_sell_tax||0)>0?a=a.times(2):y.gt(0)&&(a=a.times(1.5)),"arbitrum"===t&&(a=a.times(3.5)),"optimism"===t&&(a=a.times(4)),"base"===t&&(a=a.times(4.5));const l=n?.[0],r=s[0]?.decimals,u=new X(i.toString()),c=new X(e.from_price.toString()),m=new X(o.toString()).times(u).times(a.toString()).div(c).times(10**(r-18)).toFixed(0),d=new X(l.toString()).div(new X(100).minus(y)).times(100).plus(m);v=new X(o.toString()).times(u).times(a.toString()).div(10**18).toFixed(),s[0].amount=d.toFixed(0)}return s=s.map(e=>({...e,address:e.isETH?h:e.address})),s[0].price=e.from_price,s[s.length-1].price=e.to_price,{routerPath:s,routerPairPath:k,...e,totalTax:Math.max(Number(y.toFixed()),0),isAmountOut:!0,gas:"0".toString(),gasU:v}}):Promise.resolve({routerPath:[],routerPairPath:[]})}async function un(e,t=null){const n=te.deserialize(ne.from(e,"base64")),a=await ae(n,t);return{hash:a,wait:()=>oe(a)}}async function cn(e,t=M().address){const{fromToken:n,fromAmount:a,toToken:o,toAmount:i,expiredAt:s}=e,l={maker:t,payer:t,params:{makingAmount:a,takingAmount:i,expiredAt:s?String(s):void 0},inputMint:n,outputMint:o,computeUnitPrice:"auto"};return(r=l,J({method:"POST",url:"https://api.jup.ag/trigger/v1/createOrder",data:r})).then(e=>{const t=e.transaction;return{result:e,send:()=>un(t)}});var r}function mn({id:e,fromToken:t,fromAmount:n,toToken:a,toAmount:o,maker:i,salt:s,signature:l,minReturn:r,targetToken:u,targetLimitPrice:c,orderType:m,triggerPrice:d,currentPrice:p},f=M().chain){m=m||0,d=d||c,p=p||0;const{$api:v}=Y();return v("/v1api/v2/aveswap/limitorder/add",{method:"post",body:{order_id:e,chain:f,from_token:t,from_amount:n,to_token:a,to_amount:o,maker:i,salt:s,signature:l,to_min_amount:r,target_token:u,target_limit_price:c,order_type:m,trigger_price:d,current_price:p}})}async function dn({fromToken:e,fromAmount:t,toToken:n,minReturn:a,salt:o,id:i,order_id:s},l=M().chain){const r=await H(),u=new U(W[l],G,r);return u.cancelOrder.estimateGas(e,t,n,a,o).then(r=>u.cancelOrder(e,t,n,a,o,{gasLimit:r.toString()}).then(e=>e.wait()).then(e=>function(e,t,n=M().chain){const{$api:a}=Y();return a("/v1api/v2/aveswap/limitorder/cancel",{method:"post",body:{id:e,chain:n,order_id:t}})}(i,s,l)))}async function pn(e,t=M().address){return function(e){const{$api:t}=Y();return t("https://jup.ag/api/limit/v1/cancelOrders",{method:"post",body:e})}({owner:t,feePayer:t,orders:[e]}).then(e=>async function(e,t=null){const n=te.deserialize(ne.from(e,"base64")),a=ie(),o=await Promise.all(n.message.addressTableLookups.map(async e=>new se({key:e.accountKey,state:se.deserialize(await a.getAccountInfo(e.accountKey).then(e=>e.data))}))),i=le.decompile(n.message,{addressLookupTableAccounts:o});i.instructions=await re(i.instructions),n.message=i.compileToV0Message(o);const s=await ae(n,t);return{hash:s,wait:()=>oe(s)}}(e.tx))}async function fn(e,t=M().address){return(n={maker:t,orders:[e],computeUnitPrice:"auto"},J({method:"post",url:"https://api.jup.ag/trigger/v1/cancelOrders",data:n})).then(e=>un(e.transactions[0]));var n}const vn=["onClick"],kn={class:"flex items-center"},_n={key:0,class:"token-container"},bn={class:"icon-token-container mr-5px"},gn=["src"],hn=["innerHTML"],yn={class:"mr-5px text-12px label"},xn={key:1,class:"token-container"},wn=["innerHTML"],Tn={class:"flex items-center mt-5px"},Sn={key:0,class:"token-container"},$n={class:"icon-token-container mr-5px"},Nn=["src"],In=["innerHTML"],Mn={class:"flex items-center justify-between mt-5px"},Pn={class:"label mr-20px flex items-center"},An={key:0},Fn={class:"flex items-center"},Cn={key:0,class:"token-container"},Ln={class:"icon-token-container mr-5px"},Hn=["src"],En=["innerHTML"],Rn={class:"flex items-center mt-5px"},Un={key:0,class:"token-container"},On={class:"icon-token-container mr-5px"},jn=["src"],Dn=["innerHTML"],Bn={class:"flex justify-between mt-10px"},Vn={class:"label mr-20px"},zn={class:"token-container flex items-end flex-col",style:{"align-items":"end"}},Kn={class:"text-12px",style:{"text-align":"right"}},Wn={class:"color-666 text-12px",style:{"text-align":"right"}},Gn={class:"flex items-center justify-between mt-10px"},qn={class:"mr-20px label"},Yn={key:0,class:"color-#999 text-12px",style:{"text-align":"right"}},Jn={class:"label"},Qn={key:1,class:"color-#999 text-12px"},Zn={class:"label"},Xn={key:0,class:"flex items-center justify-between mt-10px"},ea={class:"mr-20px label"},ta={class:"color-#999 text-12px"},na=_(e({__name:"limitTxItem",props:{tableList:{type:Array,default:()=>[]}},emits:["refresh"],setup(e,{emit:n}){const a=n,m=M(),k=ce(),_=me(),T=de(),S=qe(),{t:$}=t(),P=pe({}),A=pe(!1);function F(e){const t=$("solana"===e?.chain?"cancelOrderConfirmingSolana":"confirmCancelMessage");ye.confirm(t,$("cancelOrderConfirming"),{confirmButtonText:$("confirm"),cancelButtonText:$("cancel"),beforeClose:(t,n,o)=>{"confirm"===t?(o(),n.confirmButtonLoading=!0,"solana"===e.chain?C(e,()=>{n.confirmButtonLoading=!1}):function(e){if("solana"===e.chain)return void C(e);const t={fromToken:e.from_token||"",fromAmount:e.from_amount||"0",toToken:e.to_token||"",minReturn:e.to_min_amount||"0",salt:e.salt||"0",id:e.id||"",order_id:e.order_id||""};A.value=!0,dn(t).then(t=>{xe.success($("cancelledOrderSuccessfully")),a("refresh",e)}).catch(e=>{we(e)}).finally(()=>{A.value=!1})}(e)):o()}}).then(()=>{})}function C(e,t){P.value[e.orderKey]=!0;return("v1"===e?.version?pn:fn)(e.orderKey).then(e=>(t&&t(),e.wait())).then(t=>{!function(e){if("solana"!==e.chain&&e.from_token!==h)return;S.getTokenDetails()}(e),setTimeout(()=>{a("refresh",e,P.value)},3e3)}).catch(t=>{we(t,"solana"),P.value[e.orderKey]=!1}).finally(()=>{})}function L(e){if((0===e.status||-1===e.status)&&1e3*e.created_at+_e<Date.now())return $("expired1");const t=e.status;return{0:"",1:$("cancelled"),2:$("completed"),3:$("unknownError1"),7:$("unknownError1"),4:$("notEnoughBalance"),5:$("insufficientSlippage1"),8:$("insufficientSlippage1"),6:$("transferFailed"),10:$("fail1"),11:$("fail1"),12:$("fail1"),13:$("fail1"),"-1":""}[t]??t}function H(e){if((0===e.status||-1===e.status)&&1e3*e.created_at+_e<Date.now())return"#999999";const t=e.status;return 1===t||10===t||11===t||12===t?"#999999":2===t?"#12B886":0===t?"#286DFF":"#FF0000"}function E(e){const t=["So11111111111111111111111111111111111111112","EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v","Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"];return t.indexOf(e.from_token)<=t.indexOf(e.to_token)}function R(e){return E(e)?e?.from_token_symbol||"":e?.to_token_symbol||""}function U(e){return E(e)?g(new X(e.to_amount).times(10**(e?.from_token_decimals-e?.to_token_decimals)).times(e?.to_token_price||0).div(e.from_amount).toFixed()):g(new X(e.from_amount).times(10**(e?.to_token_decimals-e?.from_token_decimals)).times(e?.from_token_price||0).div(e.to_amount).toFixed())}function O(e){return E(e)?g(e.to_amount*10**(e?.from_token_decimals-e?.to_token_decimals)/e.from_amount)+" "+(e?.to_token_symbol||"")+" per "+(e?.from_token_symbol||""):g(e.from_amount*10**(e?.to_token_decimals-e?.from_token_decimals)/e.to_amount)+" "+(e?.from_token_symbol||"")+" per "+(e?.to_token_symbol||"")}function j(e){if("Pending"===e?.state&&null!==e?.expiredAt&&Date.now()>1e3*Number(e?.expiredAt||0))return $("expired1");const t=e.state;return{Pending:"",Completed:$("completed"),Cancelled:$("cancelled")}[t]??t}function D(e){if("Pending"===e?.state&&null!==e?.expiredAt&&Date.now()>1e3*Number(e?.expiredAt||0))return"#999999";return{Pending:"",Completed:"#12B886",Cancelled:"#999999"}[e.state]??"#286DFF"}return(t,n)=>{const a=fe,S=x,$=et,M=tt;return i(),o("ul",null,[(i(!0),o(p,null,f(e.tableList,(e,f)=>(i(),o("li",{key:f,class:"tx-li-item clickable",onClick:r(t=>function(e){if("solana"===e.chain){if("Sending"===e?.state)return;const t=e?.closeTx||e?.openTx;if(!t)return;window.open(I("solana",t,"tx"))}else 2===e.status&&window.open(I(e.chain,e.executed_tx_hash,"tx"))}(e),["stop"])},["solana"!==e.chain?(i(),o(p,{key:0},[s("div",kn,[s("span",{class:"label",style:y({"min-width":"en"===u(k).locale?"30px":"20px"})},c(t.$t("from")),5),e.from_token?(i(),o("div",_n,[s("div",bn,[l(a,{class:"icon-token",src:("getSymbolDefaultIcon"in t?t.getSymbolDefaultIcon:u(N))({logo_url:e.from_token_logo_url,symbol:e.from_token_symbol,chain:e.chain||u(m).chain}),lazy:""},null,8,["src"]),e?.chain?(i(),o("img",{key:0,class:"icon-chain",src:`${u(_).token_logo_url}chain/${e?.chain}.png`,alt:"",srcset:""},null,8,gn)):b("",!0)]),s("span",{class:"mr-5px",innerHTML:("formatNumber"in t?t.formatNumber:u(g))(("formatUnits"in t?t.formatUnits:u(ve))(e.from_amount,e.from_token_decimals))},null,8,hn),s("span",null,c(e.from_token_symbol||""),1)])):b("",!0),n[0]||(n[0]=s("span",{style:{flex:"1"}},null,-1)),s("span",yn,c(t.$t("price"))+"("+c(e.target_token===e.from_token?e?.from_token_symbol||"":e?.to_token_symbol||"")+") ",1),e.target_token?(i(),o("div",xn,[s("span",{innerHTML:`$${e.target_limit_price?("formatNumber"in t?t.formatNumber:u(g))(e.target_limit_price):"--"}`},null,8,wn)])):b("",!0)]),s("div",Tn,[s("span",{class:"label",style:y({"min-width":"en"===u(k).locale?"30px":"20px"})},c(t.$t("to")),5),e.to_token?(i(),o("div",Sn,[s("div",$n,[l(a,{class:"icon-token",src:("getSymbolDefaultIcon"in t?t.getSymbolDefaultIcon:u(N))({logo_url:e.to_token_logo_url,symbol:e.to_token_symbol,chain:e.chain||u(m).chain}),lazy:""},null,8,["src"]),e?.chain?(i(),o("img",{key:0,class:"icon-chain",src:`${u(_).token_logo_url}chain/${e?.chain}.png`,alt:"",srcset:""},null,8,Nn)):b("",!0)]),s("span",{class:"mr-5px",innerHTML:("formatNumber"in t?t.formatNumber:u(g))(("formatUnits"in t?t.formatUnits:u(ve))(e.to_amount,e.to_token_decimals))},null,8,In),s("span",null,c(e?.to_token_symbol||""),1)])):b("",!0)]),s("div",Mn,[s("div",Pn,[s("span",null,c(("formatDate"in t?t.formatDate:u(ke))(e.created_at)),1),(0===e.status||-1===e.status)&&Date.now()<1e3*e.created_at+u(_e)?(i(),o("span",An," ("+c(t.$t("expiresInTime",{t:u(be)(1e3*e.created_at+u(_e)).fromNow()}))+") ",1)):b("",!0)]),1===e.status||2===e.status?(i(),o("span",{key:0,class:"status-txt",style:y({color:H(e)})},c(L(e)),5)):(i(),o(p,{key:1},[n[1]||(n[1]=s("span",{style:{flex:"1"}},null,-1)),0!==e.status||(0===e.status||-1===e.status)&&1e3*e.created_at+u(_e)<Date.now()?(i(),o("span",{key:0,class:"status-txt",style:y({color:H(e)})},c(L(e)),5)):b("",!0),e.from_token===u(h)||(0===e.status||-1===e.status)&&1e3*e.created_at+u(_e)>Date.now()?(i(),v(S,{key:1,class:"btn-s",plain:"",hairline:"",type:"primary",size:"small",loading:u(A),"loading-text":t.$t("revoke"),"loading-size":"0.28rem",onClick:r(t=>F(e),["stop"])},{default:d(()=>[w(c(t.$t("revoke")),1)]),_:1},8,["loading","loading-text","onClick"])):b("",!0)],64))])],64)):(i(),o(p,{key:1},[s("div",Fn,[s("span",{class:"label",style:y({"min-width":"en"===u(k).locale?"30px":"20px"})},c(t.$t("from")),5),e.from_token?(i(),o("div",Cn,[s("div",Ln,[l(a,{class:"icon-token",src:("getSymbolDefaultIcon"in t?t.getSymbolDefaultIcon:u(N))({logo_url:e.from_token_logo_url,symbol:e.from_token_symbol,chain:e.chain||u(m).chain}),lazy:""},null,8,["src"]),e?.chain?(i(),o("img",{key:0,class:"icon-chain",src:`${u(_).token_logo_url}chain/${e?.chain}.png`,alt:"",srcset:""},null,8,Hn)):b("",!0)]),s("span",{class:"mr-5px",innerHTML:("formatNumber"in t?t.formatNumber:u(g))(("formatUnits"in t?t.formatUnits:u(ve))(e.from_amount,e.from_token_decimals))},null,8,En),s("span",null,c(e.from_token_symbol||""),1)])):b("",!0),n[2]||(n[2]=s("span",{style:{flex:"1"}},null,-1)),"Sending"===e.state?(i(),v($,{key:1,class:"text-16px"})):(i(),o(p,{key:2},[s("span",{class:"label",style:y({color:D(e)})},c(j(e)),5),"solana"===e.chain&&"Pending"===e.state?(i(),v(S,{key:0,class:"btn-s",plain:"",hairline:"",type:"primary",size:"small",loading:u(P)[e.orderKey],"loading-text":t.$t("revoke"),"loading-size":"14px",onClick:r(t=>F(e),["stop"])},{default:d(()=>[w(c(t.$t("revoke")),1)]),_:1},8,["loading","loading-text","onClick"])):b("",!0)],64))]),s("div",Rn,[s("span",{class:"label",style:y({"min-width":"en"===u(k).locale?"30px":"20px"})},c(t.$t("to")),5),e.to_token?(i(),o("div",Un,[s("div",On,[l(a,{class:"icon-token",src:("getSymbolDefaultIcon"in t?t.getSymbolDefaultIcon:u(N))({logo_url:e.to_token_logo_url,symbol:e.to_token_symbol,chain:e.chain||u(m).chain}),lazy:""},null,8,["src"]),e?.chain?(i(),o("img",{key:0,class:"icon-chain",src:`${u(_).token_logo_url}chain/${e?.chain}.png`,alt:"",srcset:""},null,8,jn)):b("",!0)]),s("span",{class:"mr-5px",innerHTML:("formatNumber"in t?t.formatNumber:u(g))(("formatUnits"in t?t.formatUnits:u(ve))(e.to_amount,e.to_token_decimals))},null,8,Dn),s("span",null,c(e?.to_token_symbol||""),1)])):b("",!0)]),s("div",Bn,[s("span",Vn,c(t.$t("delegatePrice"))+"("+c(R(e))+")",1),s("div",zn,[s("span",Kn,"$"+c(U(e)),1),s("span",Wn,"("+c(O(e))+")",1)])]),s("div",Gn,[s("span",qn,c(t.$t("amount1")),1),E(e)?(i(),o("div",Yn,[s("span",null,c(("formatNumber"in t?t.formatNumber:u(g))(("formatUnits"in t?t.formatUnits:u(ve))(e.from_amount_used||0,e.from_token_decimals)))+"/"+c(("formatNumber"in t?t.formatNumber:u(g))(("formatUnits"in t?t.formatUnits:u(ve))(e.from_amount||0,e.from_token_decimals)))+" "+c(e.from_token_symbol),1),s("span",Jn,"("+c(("formatNumber"in t?t.formatNumber:u(g))(e.percent||0))+"%)",1)])):(i(),o("div",Qn,[s("span",null,c(("formatNumber"in t?t.formatNumber:u(g))(("formatUnits"in t?t.formatUnits:u(ve))(e.to_amount_used||0,e.to_token_decimals)))+"/"+c(("formatNumber"in t?t.formatNumber:u(g))(("formatUnits"in t?t.formatUnits:u(ve))(e.to_amount||0,e.to_token_decimals)))+" "+c(e.to_token_symbol),1),s("span",Zn,"("+c(("formatNumber"in t?t.formatNumber:u(g))(e.percent||0))+"%)",1)]))]),void 0!==e.expiredAt?(i(),o("div",Xn,[s("span",ea,c(t.$t("expiredTime")),1),s("span",ta,c(e.expiredAt?("formatDate"in t?t.formatDate:u(ke))(e.expiredAt):t.$t("never")),1)])):b("",!0)],64))],8,vn))),128)),e.tableList&&0!==e.tableList?.length?b("",!0):(i(),v(M,{key:0,"image-size":100,image:"light"===u(T).theme?u(ge):u(he)},null,8,["image"]))])}}}),[["__scopeId","data-v-d47732f3"]]),aa={class:"card-container mt-10px"},oa={class:"flex items-center"},ia=["innerHTML"],sa={class:"flex justify-between items-center mt-10px"},la={class:"card-container bottom mt-10px"},ra={class:"flex items-center"},ua=["innerHTML"],ca={class:"flex justify-between items-center mt-10px"},ma={key:0,class:"limit-price-label mb-5px"},da={key:1,class:"card-container flex justify-between items-center rd-6px! py-0!"},pa=["disabled"],fa=["disabled"],va={class:"limit-price-label mt-10px mb-5px"},ka={class:"card-container flex justify-between items-center rd-6px! py-0!",style:{"margin-bottom":"10px"}},_a=["disabled"],ba=["disabled"],ga={class:"limit-price-label mt-10px mb-5px"},ha={class:"card-container flex justify-between items-center rd-6px! py-0!",style:{"margin-bottom":"10px"}},ya=["disabled"],xa=["disabled"],wa={class:"swap-label mt-10px"},Ta={key:0,class:"slippage-container"},Sa={key:1},$a={class:"swap-label_item-left"},Na={key:1,style:{display:"flex","align-items":"center"}},Ia={class:"mt-10px"},Ma={class:"tabs-1"},Pa=["onClick"],Aa=_(e({__name:"limit",setup(e){const _=qe(),y=M(),S=n("percentStepInf"),$=a(()=>_.chain),{t:N}=t(),I=Te("limitSlippage","10"),J=pe(""),Q=pe(""),Z=pe(!1),ee=pe("0"),te=pe(""),ne=pe(0),ae=pe(!1),oe=pe(0),ie=pe(""),se=pe(""),le=pe(""),re=pe(!1),ue=pe(!1),ce=pe(!1),me=pe(null),de=pe(!1),fe=pe(!1),ke=pe(0),_e=pe([]),be=pe(!1),ge=pe(!1),he=pe("limit"),Ze=a(()=>[{name:N("historyLimitOrder"),value:"limit"}]),Xe=a(()=>{if(ge.value){const e=_.token1.address;return _e.value?.filter(t=>t.target_token===e)}return _e.value}),et=pe({chain:"",orderType:0,triggerPrice:0,fromToken:{address:"",chain:"",balance:0,symbol:"",price:0},toToken:{address:"",chain:"",balance:0,symbol:"",price:0},targetTokenInfo:{address:"",chain:"",balance:0,symbol:"",price:0},fromAmount:"",toAmount:"",targetToken:"",targetLimitPrice:"",activeTab:_.activeTab,minReturn:"0",slippage:I.value||"10"}),tt=a(()=>{if(["solana","ton","sui"].includes(_.chain)||_.fromToken.address===h)return!0;if(!ee.value)return!1;const e=(0===_.activeTab?_.token2:_.token1).decimals||0,t=0===_.activeTab?Q.value:J.value;return Se(new X(t||0).toFixed(e),e).lte(ee.value)}),at=a(()=>y.address&&y.provider?0===_.activeTab?$e[0]:1===_.activeTab?Ne[0]:"#558BED":"#999");function it(){J.value="",Q.value="",S.value?.handleClick?.(0),1===_.activeTab&&lt(),_.getToken1Info(),_.getBaseToken(),"solana"===$.value&&rt()}function st(){J.value="",Q.value="",S.value?.handleClick?.(0),_.getToken2Info(),0===_.activeTab&&lt(),"solana"===$.value&&rt()}function lt(){const e=0===_.activeTab?_.token2:_.token1;if(y.chain&&y.chain===e.chain&&e.address){const t=e.chain||y.chain;if("solana"===t)return;const n=W[t];Z.value=!0,Oe(e.address,n).then(e=>{ee.value=e.toString()}).finally(()=>{Z.value=!1})}}function rt(){if(!_.token1?.address||!_.token2?.address||"solana"!==$.value||0!==_.swapType)return;const e={from_token:_.token1?.address,to_token:_.token2?.address,amountIn:Se("1",_.token1?.decimals).toFixed(0)};te.value="",ln(e).then(e=>{const t=ve(e?.outAmount||0,_.token2?.decimals);ne.value=t,function(){const e=_.token1.chain,t=_.token1.address+"-"+e,n=_.token2.address+"-"+e;return je([t,n]).then(async e=>(_.token1.price=e?.[0]?.current_price_usd||0,_.token2.price=e?.[1]?.current_price_usd||0,[_.token1.price,_.token2.price]))}().then(e=>{}),te.value=""}).catch(e=>{ne.value=0,te.value="1"})}function ut(){ie.value&&new X(ie.value).gt("0")&&(ie.value=Pe(new X(ie.value).times(.99).toFixed()),ht())}function ct(){ie.value&&new X(ie.value).gt("0")&&(ie.value=Pe(new X(ie.value).times(1.01).toFixed()),ht())}function mt(){le.value&&new X(le.value).gt("0")&&(le.value=Pe(new X(le.value).times(.99).toFixed()))}function dt(){ie.value&&new X(le.value).gt("0")&&(le.value=Pe(new X(le.value).times(1.01).toFixed()))}function pt(){oe.value&&new X(oe.value).gt("0")&&(oe.value=Pe(new X(oe.value).times(.99).toFixed()),xt())}function ft(){oe.value&&new X(oe.value).gt("0")&&(oe.value=Pe(new X(oe.value).times(1.01).toFixed()),xt())}function vt(e,t=!1){if(t)return;const n=Number(e)/100,a=0===_.activeTab?_.token2:_.token1;let o=a.balance||0;if(n){const e=a.decimals||18;if(a?.address===h){const t=a.chain,i=De[t]||.01;o=new X(o).minus(i).times(n).toFixed().match(new RegExp(`[0-9]*(\\.[0-9]{0,${e}})?`))?.[0]||0}else o=new X(o).times(n).toFixed().match(new RegExp(`[0-9]*(\\.[0-9]{0,${e}})?`))?.[0]||0;0===Number(o)&&(o="")}else o="";0===_.activeTab?Q.value!==o&&(Q.value=Number(o)<0?"0":o,gt()):J.value!==o&&(J.value=Number(o)<0?"0":o,_t())}let kt=null;function _t(){ae.value||(kt&&(clearTimeout(kt),kt=null),kt=setTimeout(()=>{const e=J.value,t=Number(e);""===e||"."===e?(J.value="",Q.value=""):0===t&&0!==Number(Q.value)?Q.value=0:t&&(Q.value="",ht())},500))}let bt=null;function gt(){ae.value||(bt&&(clearTimeout(bt),bt=null),bt=setTimeout(()=>{const e=Q.value,t=Number(e);""===e||"."===e?(J.value="",Q.value=""):0===t&&0!==Number(J.value)?J.value=0:t&&(J.value="",ht())},500))}function ht(){"solana"!==_.chain?wt()&&(Number(ie.value)&&(Number(J.value)||Number(Q.value))&&_.token1.address!==_.token2.address&&y.provider?(yt&&(clearTimeout(yt),yt=null),yt=setTimeout(()=>{const e=0===_.activeTab?_.token2:_.token1,t=1===_.activeTab?_.token2:_.token1,n=Se((0===_.activeTab?Q.value:J.value)||"0",e.decimals).toFixed(0),a=Se((1===_.activeTab?Q.value:J.value)||"0",t.decimals).toFixed(0),o={from_token:e.address,to_token:t.address,amountIn:n,amountOut:a};ae.value=!0,async function({from_token:e,to_token:t,amountIn:n,amountOut:a},o,i=M().chain,s=3,l=3){const r=await P(e,A(i),i),u=r.balance,c=r.allowance,m=F(i),d=m?.wmain_wrapper,p=m?.main_name,f=m?.wmain_name;let v=e,k=t,_=!1,b=!1,g=!1,y=!1;return v===d&&(g=!0),k===d&&(y=!0),v===h&&(v=d,_=!0),k===h&&(k=d,b=!0),g&&b||_&&y?Promise.resolve({toWrapper:_&&y?1:2,wrapper:d,amount:"0"!==n&&n?n:a,routerPath:[{address:_?h:d,amount:"0"!==n&&n?n:a,decimals:18,isETH:_,isWrapper:g,symbol:_?p:f},{address:b?h:d,amount:"0"!==a&&a?a:n,decimals:18,isETH:b,isWrapper:y,symbol:b?p:f}]}):C(v,k,i,s,l).then(async o=>{if(0===o?.length)return Promise.reject({code:"noMatchingRoute"});const{_provider:s}=L(i),l=await H(),r="tron"===i?E(R,A(i)):new U(A(i),R,l||s),m="tron"===i?E(j,O[i]):new U(O[i],D(i),l||s),d=await B(i),f=await V(i),v={chain:i,QuoteContract:m,swapContract:r,gasPrice:d,nativePrice:f,amountIn:n,amountOut:a,balance:u,allowanceAmount:c,fromIsETH:_,toIsETH:b,mainName:p,from_token:e,to_token:t};return 1===o?.length?rn(o[0],v):2===o?.length?rn(o[0],v).catch(async e=>rn(o[1],v)):o?.length>2?rn(o[0],v).catch(async e=>rn(o[1],v).catch(async e=>rn(o[2],v))):void 0})}(o).then(e=>{if(1===e.toWrapper||2===e.toWrapper)return void(ae.value=!1);se.value=e.gasU;const t=e?.routerPath?.find?.(e=>e.address===_.token1.address),n=e?.routerPath?.find?.(e=>e.address===_.token2.address);_.token1.price=t.price,_.token2.price=n.price,new X(t?.amount||0).lte(0)||new X(n?.amount||0).lte(0)?ye.alert(N("limitOrderAmount"),N("tips"),{confirmButtonText:N("okay")}):ie.value&&J.value&&Q.value?0===_.activeTab?J.value=new X(ve(t.amount,t.decimals)).times(t.price||0).div(ie.value||1).toFixed().match(new RegExp(`[0-9]*(\\.[0-9]{0,${_.token1.decimals}})?`))?.[0]||"":Q.value=new X(ve(n.amount,n.decimals)).times(ie.value||0).div(t.price||1).toFixed().match(new RegExp(`[0-9]*(\\.[0-9]{0,${_.token2.decimals}})?`))?.[0]||"":ie.value&&J.value?Q.value=new X(ve(n.amount,n.decimals)).times(ie.value||0).div(t.price||1).toFixed().match(new RegExp(`[0-9]*(\\.[0-9]{0,${_.token2.decimals}})?`))?.[0]||"":ie.value&&Q.value&&(J.value=new X(ve(t.amount,t.decimals)).times(t.price||0).div(ie.value||1).toFixed().match(new RegExp(`[0-9]*(\\.[0-9]{0,${_.token1.decimals}})?`))?.[0]||"")}).catch(e=>{we(e)}).finally(()=>{ae.value=!1})},500)):_.token1.address===_.token2.address&&Be({type:"error",message:N("twoIdenticalTokens")})):xt()}let yt=null;function xt(){Number(oe.value)&&(Number(J.value)||Number(Q.value))&&_.token1.address!==_.token2.address&&y.provider?(yt&&(clearTimeout(yt),yt=null),yt=setTimeout(()=>{J.value?Q.value=new X(J.value||0).times(oe.value).div(_.token2?.price||1).toFixed(_.token2.decimals):Q.value&&(J.value=new X(Q.value).times(_.token2?.price||0).div(oe.value).toFixed(_.token1.decimals))},500)):_.token1.address===_.token2.address&&Be({type:"error",message:N("twoIdenticalTokens")})}function wt(){const e=y.chain,t=_.token1.chain,n=_.token2.chain,a=Object.keys(W).concat("solana");return!(t&&!a?.includes?.(t))&&(!(n&&!a?.includes?.(n))&&(!!e&&(!y.address?.startsWith?.("T")&&(!(e&&!a?.includes?.(e))&&(e===t&&e===n)))))}function Tt(){const e=y.chain,t=Object.keys(W).concat("solana"),n=F(e).name,a=_.token1.chain,o=_.token2.chain;return a&&!t?.includes?.(a)?N("noSupportChain",{chain:F(a)?.name}):o&&!t?.includes?.(o)?N("noSupportChain",{chain:F(o)?.name}):e?y.address?.startsWith?.("T")?N("noSupportChain",{chain:"TRON"}):e&&!t?.includes?.(e)?N("noSupportChain",{chain:n}):e!==a&&a||e!==o&&o?N("chainNotSame1"):a!==o?N("tokenNoSameChain"):"":N("noSupportChain",{chain:n})}function St(){if("solana"===$.value&&te.value)return!1;const e=(0===_.activeTab?_.token2:_.token1).balance||0,t=0===_.activeTab?Q.value:J.value;return!(0===Number(e)||Number(e)<Number(t)||!y.provider||"0"===String(t)||_.token1.address===_.token2.address)}function $t(){if("solana"===$.value&&te.value)return N("noSToken");const e=(0===_.activeTab?_.token2:_.token1).balance||0,t=0===_.activeTab?Q.value:J.value;return y.address?y.address&&!y.provider?N("observeAddressNotSwap"):Number(0===e||Number(e)<Number(t)||!y.provider)?N("insufficientBalance"):"0"===String(t)?N("AmountCannotBeZero"):"":N("pConnectWallet")}function Nt(){try{if(!y.provider)return void(y.provider||ye.alert(N("browserWalletNotDetected"),N("tips"),{confirmButtonText:N("confirm")}));if(!wt())return;const e=y.chain;if(e!==(_.token1.chain||_.token2.chain||e))return void ye.alert(N("plsSwitchChain",{chain:e}),N("tips"));0!==_.swapType&&1!==_.swapType||(tt.value?function(){const e=0===_.activeTab?_.token2:_.token1,t=0===_.activeTab?_.token1:_.token2,n=0===_.activeTab?Q.value:J.value,a=0===_.activeTab?J.value:Q.value,o=0===_.activeTab?_.token1.decimals:_.token2.decimals;let i=new X(I.value||0);i=new X(1).minus(i.div(100));let s=new X(ze[e.chain||y.chain]||0).times(5);s=s.gte(3)?s.gte(50)?new X(50):s:new X(3);if(!new X(n).times(e?.price||0).gte(s.times(.999)))return void ye.alert(N("minimumTransactionAmount",{n:s.toFixed()}),N("tips"),{confirmButtonText:N("okay")});const l=_.token1.chain||y.chain;et.value={chain:l,orderType:_.swapType,fromToken:e,toToken:t,fromAmount:n,toAmount:a,targetToken:_.token1.address,targetTokenInfo:_.token1,targetLimitPrice:"solana"===l?oe.value:ie.value,triggerPrice:le.value,activeTab:_.activeTab,minReturn:new X(a||0).times(i).toFixed().match(new RegExp(`[0-9]*(\\.[0-9]{0,${o}})?`))?.[0]||"0",slippage:I.value},ke.value=1,"solana"===l?(ue.value=!0,je([et.value.targetToken+"-"+l]).then(e=>{const t=e?.[0]?.current_price_usd||et.value?.targetTokenInfo?.price||_.baseToken?.token.current_price_usd||0;0===_.activeTab&&new X(t).lt(et.value?.targetLimitPrice||"0")?ye.alert(N("limitPriceTips",{p1:g(et.value?.targetLimitPrice),p2:g(t)}),N("tips"),{confirmButtonText:N("okay")}):1===_.activeTab&&new X(t).gt(et.value?.targetLimitPrice||"0")?ye.alert(N("limitPriceTips1",{p1:g(et.value?.targetLimitPrice),p2:g(t)}),N("tips"),{confirmButtonText:N("okay")}):(de.value=!0,ue.value=!1)}).catch(()=>{de.value=!0,ue.value=!1}).finally(()=>{ue.value=!1})):de.value=!0}():async function(){if(!wt())return;ce.value=!0;const e=_.token1.chain||y.chain||"",t=W[e],n=0===_.activeTab?_.token2:_.token1;Ve(n.address,t).then(e=>e.wait()).then(e=>{lt()}).catch(e=>{we(e)}).finally(()=>{ce.value=!1})}())}catch(e){}}function It(){if(!wt())return;let e=new X(I.value||0);e=new X(1).minus(e.div(100));const t=y.address,n=0===_.activeTab?_.token2:_.token1,a=0===_.activeTab?_.token1:_.token2,o=0===_.activeTab?Q.value:J.value,i=0===_.activeTab?J.value:Q.value,s=n.address,l=Se(new X(o||0).toFixed().match(new RegExp(`[0-9]*(\\.[0-9]{0,${n.decimals}})?`))?.[0]||0,n.decimals).toFixed(0),r=a.address,u=Se(new X(i||0).toFixed().match(new RegExp(`[0-9]*(\\.[0-9]{0,${a.decimals}})?`))?.[0]||0,a.decimals).toFixed(0),c=Se(new X(i||0).times(e).toFixed().match(new RegExp(`[0-9]*(\\.[0-9]{0,${a.decimals}})?`))?.[0]||0,a.decimals).toFixed(0),m=_.token1.address,d=ie.value;fe.value=!0;const p=_.swapType;le.value;const f=_.baseToken?.token?.current_price_usd?Pe(_.baseToken.token.current_price_usd):"";if("solana"===_.chain){const e=me.value?Number(Math.floor(Date.now()/1e3)+Math.floor(me.value)):null;let t="";return void cn({fromToken:s,fromAmount:l,toToken:r,toAmount:u,expiredAt:e}).then(e=>{const n=e.result;return t=n.order,e.send()}).then(o=>{const i={from_token:s,from_token_symbol:n?.symbol,from_token_decimals:n?.decimals,to_token:r,to_token_symbol:a?.symbol,to_token_decimals:a?.decimals,from_amount:Number(l)||0,to_amount:Number(u)||0,id:t,orderKey:t,chain:"solana",created_at:0,state:"Sending",from_amount_used:"0",percent:"0",expiredAt:e,from_token_logo_url:n.logo_url,to_token_logo_url:a.logo_url};return nt({chain:"solana",destination:"wallet rpc",type:20,order_id:"jupiter_"+t,status:1,wallet:y.address,out_token:r,out_amount:i.to_amount,in_token:s,in_amount:i.from_amount}),_e.value=[i,..._e.value],fe.value=!1,de.value=!1,o.wait()}).then(()=>{Mt(t),J.value="",Q.value="",n.address===_.token1.address?_.getToken1Info():n.address===_.token2.address&&_.getToken2Info()}).catch(e=>{_e.value=_e.value.filter(e=>e.orderKey!==t),we(e,"solana")}).finally(()=>{fe.value=!1,de.value=!1})}(async function(e,t,n,a,o,i,s,l,r,u,c,m=Date.now(),d=M().chain){const p=z(K.defaultAbiCoder().encode(["address","address","uint256","address","uint256","uint256"],[e,t,n,a,o,m])),f=M(),v=await H();if(t===h){const k=new U(W[d],G,v);return k.depositEth.estimateGas(a,o,m,{value:n}).then(v=>k.depositEth(a,o,m,{value:n,gasLimit:v.toString()}).then(e=>e.wait()).then(v=>{const k={id:p,fromToken:t,fromAmount:n,toToken:a,toAmount:i,minReturn:o,targetToken:s,targetLimitPrice:l,salt:m,signature:"",maker:e,orderType:r,triggerPrice:u,currentPrice:c};return nt({chain:d,destination:"wallet rpc",type:20,order_id:"aveswap_"+p,status:1,wallet:f.address,out_token:a,out_amount:i,in_token:t,in_amount:n}),mn(k)}))}const k=q(p);return v?.signMessage(k).then(d=>mn({id:p,fromToken:t,fromAmount:n,toToken:a,toAmount:i,minReturn:o,targetToken:s,targetLimitPrice:l,salt:m,signature:d,maker:e,orderType:r,triggerPrice:u,currentPrice:c}))})(t,s,l,r,c,u,m,d,p,le.value,f).then(()=>{xe.success(N("submitOrdersSuccess")),Mt(),J.value="",Q.value="",de.value=!1,n.address===h&&(n.address===_.token1.address?_.getToken1Info():n.address===_.token2.address&&_.getToken2Info())}).catch(e=>{we(e)}).finally(()=>{fe.value=!1})}function Mt(e,t){if(y.chain){const n=y.chain;if("solana"===n)return void Ft(e,t);be.value=!0,function(e,t=1,n=1e3){const a=M(),o=e.chain||a.chain||"",i=e.maker||a.address||"";if(!o||!i)return Promise.resolve([]);const{$api:s}=Y();return s("/v1api/v2/aveswap/limitorder",{method:"get",query:{pageNO:t,pageSize:n,...{maker:i,chain:o,...e}}}).then(e=>Promise.resolve(e?.data?.data||e?.data||e||[]))}({chain:n}).then(e=>{_e.value=e}).finally(()=>{setTimeout(()=>{be.value=!1},800)})}}let Pt=null,At=0;function Ft(e,t=1){if("solana"===y.chain)return be.value=!0,Promise.all([Ke({wallet:y.address}),We({wallet:y.address,take:100})]).then(async n=>{const a=n?.[0]?.map?.(e=>[e?.inputMint+"-solana",e?.outputMint+"-solana"])||[],o=n?.[1]?.map?.(e=>[e?.inputMint+"-solana",e?.outputMint+"-solana"])||[],i=Array.from(new Set([...a?.flat?.(),...o?.flat()])),s=await Ge(i).catch(async e=>({})),l=n?.[0]?.map?.(e=>{const t=s[e.inputMint+"-solana"]?.decimal,n=s[e.outputMint+"-solana"]?.decimal;return{...e,from_token:e.inputMint,from_token_symbol:s[e.inputMint+"-solana"]?.symbol,from_token_decimals:s[e.inputMint+"-solana"]?.decimal,from_token_price:s[e.inputMint+"-solana"]?.current_price_usd,to_token:e.outputMint,to_token_symbol:s[e.outputMint+"-solana"]?.symbol,to_token_decimals:s[e.outputMint+"-solana"]?.decimal,to_token_price:s[e.outputMint+"-solana"]?.current_price_usd,from_amount:new X(e.makingAmount||0)?.times?.(10**t)?.toFixed(0)||0,to_amount:new X(e.takingAmount||0)?.times?.(10**n)?.toFixed(0)||0,chain:"solana",from_amount_used:new X(e.makingAmount||0).minus(e.remainingMakingAmount)?.times?.(10**t).toFixed(0),to_amount_used:new X(e.takingAmount||0).minus(e.remainingTakingAmount)?.times(10**n).toFixed(0),percent:new X(e.makingAmount||0).minus(e.remainingMakingAmount).div(e.makingAmount).times(100).toFixed(),from_token_logo_url:s[e.inputMint+"-solana"]?.logo_url,to_token_logo_url:s[e.outputMint+"-solana"]?.logo_url,id:e.orderKey,state:"Pending"}}),r=n?.[1]?.map?.(e=>{const t=s[e.inputMint+"-solana"]?.decimal,n=s[e.outputMint+"-solana"]?.decimal;return{...e,from_token:e.inputMint,from_token_symbol:s[e.inputMint+"-solana"]?.symbol,from_token_decimals:s[e.inputMint+"-solana"]?.decimal,from_token_price:s[e.inputMint+"-solana"]?.current_price_usd,to_token:e.outputMint,to_token_symbol:s[e.outputMint+"-solana"]?.symbol,to_token_decimals:s[e.outputMint+"-solana"]?.decimal,to_token_price:s[e.outputMint+"-solana"]?.current_price_usd,from_amount:new X(e.makingAmount||0)?.times?.(10**t)?.toFixed(0)||0,to_amount:new X(e.takingAmount||0)?.times?.(10**n)?.toFixed(0)||0,chain:"solana",from_amount_used:new X(e.makingAmount||0).minus(e.remainingMakingAmount)?.times?.(10**t).toFixed(0),to_amount_used:new X(e.takingAmount||0).minus(e.remainingTakingAmount)?.times(10**n).toFixed(0),percent:new X(e.makingAmount||0).minus(e.remainingMakingAmount).div(e.makingAmount).times(100).toFixed(),from_token_logo_url:s[e.inputMint+"-solana"]?.logo_url,to_token_logo_url:s[e.outputMint+"-solana"]?.logo_url,id:e.orderKey,state:e.status}}),u=[...l,...r],c=u?.some(t=>t.orderKey===e),m=u?.some(t=>t.orderKey===e&&"Cancelled"===t.state);return e&&At<=30&&(0!==t&&!c||0===t&&!m)?(Pt&&(clearTimeout(Pt),Pt=null),new Promise(n=>{Pt=setTimeout(()=>{At+=5,Ft?.(e,t)?.then(e=>{n(e)})},5e3)})):(be.value=!1,_e.value=u?.filter?.(n=>!(n.orderKey===e&&"Pending"===n.state&&0===t)),At=0,u)}).catch(e=>{At=0,be.value=!1})}function Ct(e,t){"solana"===e.chain?Ft?.(e.publicKey,0)?.then(()=>{t&&(t[e.publicKey]=!1)}):Mt()}return Ie(()=>_.fromToken.address,()=>{_.fromToken.address&&(J.value="",Q.value="",lt())}),Ie(()=>y.address,()=>{y.address&&(lt(),Mt())}),Me(()=>{lt(),Mt(),"solana"!==$.value?(ie.value=_.baseToken?.token?.current_price_usd?Pe(_.baseToken.token.current_price_usd):"",le.value=_.baseToken?.token?.current_price_usd?Pe(_.baseToken.token.current_price_usd):""):oe.value=_.baseToken?.token?.current_price_usd?g(_.baseToken.token.current_price_usd):"",rt()}),(e,t)=>{const n=Fe,a=T,h=x,M=m;return i(),o(p,null,[s("form",{class:"swap-container",action:"",onSubmit:r(Nt,["prevent","stop"])},[s("div",aa,[s("div",oa,[l(Ye,{token:u(_).token1,"onUpdate:token":[t[0]||(t[0]=e=>u(_).token1=e),it],tokens:u(_).swapTokens,chain:u(_).chain},null,8,["token","tokens","chain"]),t[21]||(t[21]=s("span",{style:{flex:"1"}},null,-1)),s("div",{class:"s-text",innerHTML:`${e.$t("balance1")}: ${("formatNumber"in e?e.formatNumber:u(g))(u(_).token1?.balance||0)}`},null,8,ia),1===u(_).activeTab?(i(),o("button",{key:0,class:"max-btn",type:"button",onClick:t[1]||(t[1]=r(e=>vt(100),["stop"]))},c(e.$t("max")),1)):b("",!0)]),s("div",sa,[l(n,{modelValue:u(J),"onUpdate:modelValue":[t[2]||(t[2]=e=>k(J)?J.value=e:null),t[3]||(t[3]=e=>{J.value=e?.replace?.(/\-|[^\d.]/g,""),_t()})],placeholder:"0.0",size:"large",clearable:"",class:"input-number","input-style":"text-align:right",onFocus:t[4]||(t[4]=e=>u(S)?.handleClick(0,!0))},null,8,["modelValue"])])]),s("div",la,[s("div",ra,[l(Ye,{token:u(_).token2,"onUpdate:token":[t[5]||(t[5]=e=>u(_).token2=e),st],tokens:u(_).swapTokens,chain:u(_).chain},null,8,["token","tokens","chain"]),t[22]||(t[22]=s("span",{style:{flex:"1"}},null,-1)),s("div",{class:"s-text",innerHTML:`${e.$t("balance1")}: ${("formatNumber"in e?e.formatNumber:u(g))(u(_).token2?.balance||0)}`},null,8,ua),0===u(_).activeTab?(i(),o("button",{key:0,class:"max-btn",type:"button",onClick:t[6]||(t[6]=r(e=>vt(100),["stop"]))},c(e.$t("max")),1)):b("",!0)]),s("div",ca,[l(n,{modelValue:u(Q),"onUpdate:modelValue":[t[7]||(t[7]=e=>k(Q)?Q.value=e:null),t[8]||(t[8]=e=>{Q.value=e?.replace?.(/\-|[^\d.]/g,""),gt()})],placeholder:"0.0",size:"large",clearable:"",class:"input-number","input-style":"text-align:right",onFocus:t[9]||(t[9]=e=>u(S)?.handleClick(0,!0))},null,8,["modelValue"])])]),l(Je,{ref:"percentStepInf",activeColor:0===u(_).activeTab?("upColor"in e?e.upColor:u($e))[0]:("downColor"in e?e.downColor:u(Ne))[0],onChange:vt},null,8,["activeColor"]),1===u(_).swapType?(i(),o("div",ma,c(e.$t("triggerPrice"))+"("+c(u(_).token1.symbol||"")+")",1)):b("",!0),1===u(_).swapType?(i(),o("div",da,[s("button",{class:"limit-price-icon",type:"button",disabled:!u(le),onClick:r(mt,["stop"])},[l(a,null,{default:d(()=>[l(u(Ce))]),_:1})],8,pa),t[23]||(t[23]=s("span",{class:"text-14px color-[--d-666-l-999]"},"$",-1)),l(n,{modelValue:u(le),"onUpdate:modelValue":[t[10]||(t[10]=e=>k(le)?le.value=e:null),t[11]||(t[11]=e=>{le.value=e?.replace?.(/\-|[^\d.]/g,"")})],placeholder:"0.0",size:"large",clearable:"",class:"input-number","input-style":"text-align:center"},null,8,["modelValue"]),s("button",{class:"limit-price-icon",type:"button",disabled:!u(le),onClick:r(dt,["stop"])},[l(a,null,{default:d(()=>[l(u(Le))]),_:1})],8,fa)])):b("",!0),"solana"===u(_).chain&&0===u(_).swapType?(i(),o(p,{key:2},[s("div",va,c(e.$t("delegatePrice"))+"("+c(u(_).token1.symbol||"")+")",1),s("div",ka,[s("button",{class:"limit-price-icon",type:"button",disabled:!u(oe),onClick:r(pt,["stop"])},[l(a,null,{default:d(()=>[l(u(Ce))]),_:1})],8,_a),t[24]||(t[24]=s("span",{class:"text-14px color-[--d-666-l-999]"},"$",-1)),l(n,{modelValue:u(oe),"onUpdate:modelValue":[t[12]||(t[12]=e=>k(oe)?oe.value=e:null),t[13]||(t[13]=e=>{oe.value=e?.replace?.(/\-|[^\d.]/g,""),xt()})],placeholder:"0.0",size:"large",clearable:"",class:"input-number","input-style":"text-align:center"},null,8,["modelValue"]),s("button",{class:"limit-price-icon",type:"button",disabled:!u(oe),onClick:r(ft,["stop"])},[l(a,null,{default:d(()=>[l(u(Le))]),_:1})],8,ba)])],64)):(i(),o(p,{key:3},[s("div",ga,c(e.$t("delegatePrice"))+"("+c(u(_).token1.symbol||"")+")",1),s("div",ha,[s("button",{class:"limit-price-icon",type:"button",disabled:!u(ie),onClick:r(ut,["stop"])},[l(a,null,{default:d(()=>[l(u(Ce))]),_:1})],8,ya),t[25]||(t[25]=s("span",{class:"text-14px color-[--d-666-l-999]"},"$",-1)),l(n,{modelValue:u(ie),"onUpdate:modelValue":[t[14]||(t[14]=e=>k(ie)?ie.value=e:null),t[15]||(t[15]=e=>{ie.value=e?.replace?.(/\-|[^\d.]/g,""),ht()})],placeholder:"0.0",size:"large",clearable:"",class:"input-number","input-style":"text-align:center"},null,8,["modelValue"]),s("button",{class:"limit-price-icon",type:"button",disabled:!u(ie),onClick:r(ct,["stop"])},[l(a,null,{default:d(()=>[l(u(Le))]),_:1})],8,xa)])],64)),u(y).address?u(y).address&&!u(y).provider?(i(),v(h,{key:5,"native-type":"button",class:"submit-btn",disabled:"",color:"#555555"},{default:d(()=>[w(c(e.$t("watchWalletNotSwap")),1)]),_:1})):wt()?!u(tt)||u(Z)?(i(),v(h,{key:7,class:"submit-btn",block:"",color:u(at),"native-type":"submit","loading-text":u(Z)?e.$t("checkingAllowance"):u(re)?e.$t("quoting"):u(ce)?e.$t("approve"):"",disabled:!St(),loading:u(ce)||u(ue)||u(Z)},{default:d(()=>[w(c($t()||e.$t("approve")),1)]),_:1},8,["color","loading-text","disabled","loading"])):(i(),v(h,{key:8,class:"submit-btn",block:"",loading:u(ue)||u(ae),"loading-text":u(ae)?e.$t("quoting"):u(ue)?0===u(_).activeTab?e.$t("buying"):e.$t("selling"):e.$t("quoting"),color:u(at),disabled:!St()||!u(J)||!u(Q)||u(Z),"native-type":"submit"},{default:d(()=>[w(c($t()||(0===u(_).activeTab?e.$t("buy"):e.$t("sell"))+" "+(u(_).token1?.symbol||"")),1)]),_:1},8,["loading","loading-text","color","disabled"])):(i(),v(h,{key:6,"native-type":"button",class:"submit-btn",disabled:"",block:"",color:"#555555"},{default:d(()=>[w(c(Tt()),1)]),_:1})):(i(),v(h,{key:4,"native-type":"button",class:"submit-btn",color:"#286DFF",onClick:t[16]||(t[16]=r(t=>("useBotStore"in e?e.useBotStore:u(He))().changeConnectVisible(!0,1),["stop"]))},{default:d(()=>[w(c(e.$t("pConnectWallet")),1)]),_:1})),s("ul",wa,["solana"!==u($)?(i(),o("li",Ta,[s("span",null,c(e.$t("slippage")),1),l(M,{name:"material-symbols:help-outline",onClick:t[17]||(t[17]=r(t=>{return n=e.$t("slippage"),a=e.$t("minimumReceivedTips"),void ye.alert(a,n,{confirmButtonText:N("getIt")}).then(()=>{});var n,a},["stop"]))}),t[26]||(t[26]=s("span",{style:{flex:"1"}},null,-1)),l(Qe,{slippage:u(I),"onUpdate:slippage":t[18]||(t[18]=e=>k(I)?I.value=e:null),canSetAuto:!1},null,8,["slippage"])])):b("",!0),0===u(_).swapType||1===u(_).swapType?(i(),o("li",Sa,[s("div",$a,[s("span",null,c(e.$t("limitExpiredTime")),1)]),0===u(_).swapType&&"solana"===u($)?(i(),v(ot,{key:0,expiredTime:u(me),"onUpdate:expiredTime":t[19]||(t[19]=e=>k(me)?me.value=e:null)},null,8,["expiredTime"])):(i(),o("div",Na,c(u(Ee))+" "+c(e.$t("days1")),1))])):b("",!0)])],32),Ae(s("div",Ia,[s("div",Ma,[(i(!0),o(p,null,f(u(Ze),(e,t)=>(i(),o("button",{key:t,class:Ue(["tab-item",{active:e.value===u(he)}]),type:"button",onClick:r(t=>he.value=e.value,["stop"])},c(e.name),11,Pa))),128))]),Ae(l(na,{class:"mt-5px",tableList:u(Xe),onRefresh:Ct},null,8,["tableList"]),[[Re,"limit"===u(he)]])],512),[[Re,2!==u(_).swapType]]),l(sn,{visible:u(de),"onUpdate:visible":t[20]||(t[20]=e=>k(de)?de.value=e:null),limitInfo:u(et),loading:u(fe),chain:u(y).chain,limitGasU:u(se),activeShow:u(ke),onSubmit:It},null,8,["visible","limitInfo","loading","chain","limitGasU","activeShow"])],64)}}}),[["__scopeId","data-v-edf51c8b"]]);export{Aa as default};
