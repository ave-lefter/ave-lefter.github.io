import{_ as a}from"./U3Xc_iuw.js";import{E as e}from"./B7E30Deu.js";import{f as t,v as i,y as s,ah as r,r as o,g as n,I as c,x as l,m,n as p,aj as u,ai as v,q as d,Q as _,R as h,a3 as g,ak as y,al as b,b as k,c as f,o as j,U as w,K as x,B as C,am as T,i as I,a4 as S,a1 as z,D as N,w as O,an as A,F as q,aq as E,ar as F,_ as $}from"#entry";import"./Div4Sb7D.js";import"./DMZvEsQv.js";import"./1bXUUYzG.js";import{H as V,e as L,h as P,I as B,i as R,j as D,k as H,l as K,m as U,n as M,o as G,p as Q,t as X,v as J,w as W,x as Y,y as Z,z as aa,A as ea,B as ta,D as ia,C as sa,E as ra,F as oa,P as na,G as ca}from"./Qs9mOPVL.js";import{g as la}from"./ByIPt4Po.js";import"./Ci0kdpII.js";import"./htzw4K3n.js";import"./DWsaYBFQ.js";import"./EyvYgUJ0.js";import"./DYraDxUd.js";import"./DIeWaiUl.js";import"./DZrW0QoB.js";import"./CZIhrSUn.js";import"./DhoqPgLY.js";import"./Dm8Xip1S.js";import"./BJUavsLo.js";import"./BYHD6w5R.js";import"./5S8AQ56A.js";import"./BUyr3k23.js";import"./Dj5W2tf4.js";import"./BuTxD5e6.js";const ma=$(t({__name:"activity",props:{listMapFunction:{type:Function},activeChain:{},activeSubTab:{},activeTab:{},height:{},ammList:{}},setup(t){const{t:$}=i(),ma=s(),pa=t,{rankConditions:ua}=r(ma);function va(a){ua.value[pa.activeTab].sort=a,ga.value.pageNO=1,wa()}function da(...a){a.forEach(a=>{E(ua.value[pa.activeTab].filter,a[0],a[1])}),ga.value.pageNO=1,wa()}const _a=o([]),ha=n(()=>ma.pumpSetting.isBlacklist?_a.value.filter(a=>{return e=a,!(-1!==ma.pumpBlackList.findIndex(a=>a.address==e.token&&"ca"==a.type||a.address==e.symbol&&"keyword"==a.type));var e}):_a.value);const ga=o({pageNO:1,pageSize:50,total:0}),ya=c(!1),ba=n(()=>pa.activeTab+"TableColumns");let ka,fa=l(ba.value,V($));function ja({rowData:a}){F(`/token/${a.target_token}-${a.chain}`)}async function wa(a=!0){try{a&&(ya.value=!0);const{total:e,...t}=ga.value,i=_().evmAddress||h().address||"",s=["created_at_max","created_at_min"].reduce((a,e)=>(a[e]&&(a[e]=g().unix()-60*Number(a[e])),a),{...ua.value[pa.activeTab]?.filter}),r=await la({category:pa.activeTab,...t,chain:"AllChains"!==pa.activeChain?pa.activeChain:"",...ua.value[pa.activeTab]?.sort,...s,self_address:i});ga.value.total=r.total,_a.value=(r.data||[]).map(pa.listMapFunction),a&&function(){xa.send({jsonrpc:"2.0",method:"unsubscribe",params:["price_extra"],id:1});const a=_a.value.map(a=>`${a.pair}-${a.chain}`);xa.send({jsonrpc:"2.0",method:"subscribe",params:["price_extra",a],id:1})}(),clearTimeout(ka),ka=window.setTimeout(()=>{wa(!1)},1e4)}finally{ya.value=!1}}m(()=>pa.activeTab,()=>{Aa(),fa=l(ba.value,V($)),ga.value.pageNO=1,wa()},{immediate:!0}),p(()=>{wa()}),u(()=>{clearTimeout(ka)}),v(()=>{Aa(),clearTimeout(ka),ka=window.setTimeout(()=>{wa(!1)},1e4)}),d(()=>{clearTimeout(ka)}),m(()=>[pa.activeChain,pa.activeTab],()=>{ga.value.pageNO=1,wa()});const xa=y();m(()=>xa.wsResult[b.PRICE_EXTRA],({prices:a})=>{const e=Array.isArray(a)?a.reduce((a,e)=>(a[e.pair+"-"+e.chain]=e,a),{}):{},t=_a.value.map(a=>{const t=e[a.pair+"-"+a.chain];if(t){delete t.holders,delete t.last_trade_at;const e=a.current_price_usd?(a.market_cap||0)/a.current_price_usd*(t.uprice||0):0;return{...a,market_cap:e,current_price_usd:t.uprice,...t}}return a}),{sort:i,sort_dir:s}=ua.value[pa.activeTab]?.sort,r={asc:"1",desc:"-1"}[s];r&&(_a.value=t.toSorted((a,e)=>(a[i]-e[i])*r))});const Ca=h(),Ta=_();function Ia(){ga.value.pageNO=1,wa()}n(()=>Ta.evmAddress||Ca.address);const Sa={price_change_dynamic:a=>a.isVisible&&!["1m","24h"].includes(ma.rankCommon.activeInterval),quick:a=>a.isVisible&&ma.rankCommon.quickVisible},za=n(()=>fa.value.filter(a=>Sa[a.key]?Sa[a.key](a):a.isVisible)),Na=n(()=>({poolPair:Q,headline:()=>$("aiSummary"),mCap:G,price_change_1m:M,price_change_24h:M,price_change_dynamic:M,tvl:U,dynamicVolAndTxs:K,markers_dynamic:H,holders:D,smart_money_buy_volume_24h:R,dex:B,security:()=>$("security"),holders_top10_ratio:P,quick:()=>$("quick"),sniper_tx_count:L})),Oa=n(()=>({poolPair:na,headline:oa,mCap:ra,price_change_1m:({row:a})=>k(ca,{row:a,activeInterval:"1m"},null),price_change_24h:({row:a})=>k(ca,{row:a,activeInterval:"24h"},null),price_change_dynamic:({row:a})=>k(ca,{row:a,activeInterval:ma.rankCommon.activeInterval},null),tvl:sa,dynamicVolAndTxs:ia,markers_dynamic:ta,holders:ea,smart_money_buy_volume_24h:aa,dex:Z,security:Y,holders_top10_ratio:W,quick:J,sniper_tx_count:X}));function Aa(){ua.value[pa.activeTab]||(ua.value[pa.activeTab]={sort:{sort:"",sort_dir:""},filter:{}})}return(i,s)=>{const r=a,o=e,n=T;return j(),f(q,null,[w((j(),f("div",{style:S(`height:${t.height}`)},[k(r,{rowKey:"rowKey",loading:I(ya),data:I(ha),columns:I(za),"header-height":40,"row-height":81,fixed:"",style:{"--el-bg-color":"var(--secondary-bg)"},"row-class":"cursor-pointer [&&]:[--el-table-border:1px_solid_var(--main-divider)]",rowEventHandlers:{onClick:ja}},z({_:2},[N(I(za),a=>({name:`header-${a.key}`,fn:O(()=>[(j(),x(A(I(Na)[a.key]),{key:t.activeTab,sortConditions:I(ua)[t.activeTab]?.sort,setSortConditions:va,setFilterForm:da,activeInterval:a.activeInterval||I(ma).rankCommon.activeInterval,ammList:"dex"===a.key?t.ammList:null},null,8,["sortConditions","activeInterval","ammList"]))])})),N(I(za),a=>({name:`cell-${a.key}`,fn:O(({row:e,rowIndex:i})=>[(j(),x(A(I(Oa)[a.key]),{class:"text-14px",row:e,rowIndex:i,pageNO:I(ga).pageNO,pageSize:I(ga).pageSize,activeInterval:a.activeInterval||I(ma).rankCommon.activeInterval,activeChain:t.activeChain},null,8,["row","rowIndex","pageNO","pageSize","activeInterval","activeChain"]))])}))]),1032,["loading","data","columns","rowEventHandlers"])],4)),[[n,I(ya)]]),I(ga).total?(j(),x(o,{key:0,"current-page":I(ga).pageNO,"onUpdate:currentPage":s[0]||(s[0]=a=>I(ga).pageNO=a),"page-size":I(ga).pageSize,"onUpdate:pageSize":s[1]||(s[1]=a=>I(ga).pageSize=a),class:"mt-5px py-9px flex justify-center [&&]:[--el-pagination-button-height:18px]",layout:"total, prev, pager, next",total:I(ga).total||0,small:!1,"page-sizes":[20,50,100,200,300,400],onSizeChange:Ia,onCurrentChange:s[2]||(s[2]=()=>wa())},null,8,["current-page","page-size","total"])):C("",!0)],64)}}}),[["__scopeId","data-v-a0fd1194"]]);export{ma as default};
