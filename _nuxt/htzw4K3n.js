import{f as e,r as t,v as a,g as s,q as o,K as r,o as n,Z as l,i,w as u,a as c,J as d,c as m,B as p,b as v,F as _,D as h,aE as b,N as f,s as k,H as g,d as y,C as x,t as w,G as $,ad as C,a2 as S,bg as P,cX as F,I as N,R as M,Q as A,a0 as T,dj as D,dk as I,dm as B,b0 as E,cs as R,bQ as Y,O as L,cP as O,bO as H,m as W,dn as G,dp as V,M as q,$ as z,a8 as U,_ as j,aa as K,cr as J,cZ as X,bH as Q,y as Z,ay as ee,cg as te,dq as ae,dr as se,ds as oe,dt as re,ak as ne,z as le,du as ie,dv as ue,dw as ce,dx as de,dy as me,bJ as pe,V as ve,dz as _e,dA as he,dB as be,dC as fe,cW as ke,a3 as ge,dD as ye,al as xe,dE as we,x as $e,cO as Ce,P as Se,dF as Pe,b1 as Fe,n as Ne,a4 as Me,U as Ae,bh as Te,dG as De,dH as Ie,dI as Be,bq as Ee}from"#entry";import{u as Re}from"./DWsaYBFQ.js";const Ye={class:"flex mt-4px"},Le=e({__name:"collect",props:{iconClass:{},isCollected:{type:Boolean},userFavoriteGroups:{}},emits:["collect","newGroupAndCollect"],setup(e,{emit:P}){const F=e,N=P,M=t(0),A=t(""),T=t(!1),D=t(!1),I=t(!1),{t:B}=a(),E=s(()=>[{name:B("defaultGroup"),group_id:0}].concat(F.userFavoriteGroups));function R(){C()&&(F.isCollected?N("collect"):D.value=!0)}const Y=()=>{if(A.value){if(E.value.find(e=>e.name===A.value))return void S.error(B("groupNameAlreadyExists"));N("newGroupAndCollect",A.value)}else N("collect",M.value);L()};function L(){D.value=!1,A.value="",T.value=!1}return document.addEventListener("click",L),o(()=>{document.removeEventListener("click",L)}),(t,a)=>{const s=x,o=b,C=f,S=g,P=l;return n(),r(P,{"popper-class":"[&&]:[--el-popover-padding:0]",visible:i(D),trigger:"click",width:"248px"},{reference:u(()=>[v(s,{name:"custom:star",class:$(`${e.iconClass} ${e.isCollected?"color-[--yellow]":"color-[--icon-color]"}`),onClick:d(R,["self","stop"])},null,8,["class"])]),default:u(()=>[c("div",{class:"flex flex-col gap-8px p-12px",onClick:a[2]||(a[2]=d(()=>{},["stop"]))},[(n(!0),m(_,null,h(i(E),e=>(n(),m("div",{key:e.group_id},[v(o,{class:"[--el-checkbox-height:14px]",label:e.name,modelValue:i(M)===e.group_id,onChange:t=>{return a=e.group_id,M.value=a,void(A.value="");var a}},null,8,["label","modelValue","onChange"])]))),128)),i(T)?(n(),r(C,{key:0,modelValue:i(A),"onUpdate:modelValue":a[0]||(a[0]=e=>k(A)?A.value=e:null),modelModifiers:{trim:!0},clearable:"",placeholder:t.$t("enterGroupName"),maxlength:20},null,8,["modelValue","placeholder"])):p("",!0),v(S,{disabled:i(T),class:"w-full",onClick:a[1]||(a[1]=e=>T.value=!0)},{default:u(()=>[v(s,{name:"material-symbols:add-circle",class:"mr-4px"}),y(w(t.$t("newGroup")),1)]),_:1},8,["disabled"]),c("div",Ye,[v(S,{class:"flex-1",onClick:L},{default:u(()=>[y(w(t.$t("cancel")),1)]),_:1}),v(S,{loading:i(I),class:"flex-1",type:"primary",onClick:Y},{default:u(()=>[y(w(t.$t("confirm")),1)]),_:1},8,["loading"])])])]),_:1},8,["visible"])}}});function Oe(e,t){const{$api:a}=P();return a(`/v1api/v2/tokens/${e}/vote/support`,{method:"post",body:{user_address:t}})}function He(e,t){const{$api:a}=P();return a(`/v1api/v2/tokens/${e}/vote/against`,{method:"post",body:{user_address:t}})}function We(e,t){const{$api:a}=P();return a("/v1api/v2/tokens/contract/vote",{method:"get",query:{token_id:e,user_address:t}})}function Ge(e){const{$api:t}=P();return t("/v1api/v2/tokens/lp_holders",{method:"get",query:{token_id:e}})}const Ve=F("check",()=>{const e=t(null),a=N(!1),s=N(0),o=N(!1),r=N(0),n=N(0),l=N(0);function i(e){return e?.lock||/lock|null|(black hole)/gi.test(e?.mark||"")}return{hasLpLock:o,progress:s,showResult:a,checkResult:e,statistics_risk_store:r,statistics_warning_store:n,statistics_unknown_store:l,getContractCheckResult:function(t,r){(function(e,t){const{$api:a}=P();return a("/v1api/v2/tokens/contract",{method:"get",query:{token_id:e,type:"token",user_address:t}})})(t,r).then(t=>{const r=t.token_contract,n=r?.contract_data?.audits_info;let l=null;n&&(l=JSON.parse(n));const u=r?.contract_data?.owner_txs?.filter(e=>e?.params&&e?.params?.length>0)||[];null!==r.contract_data&&(a.value=!0);const c=(r.contract_data?.pair_holders_rank||[]).reduce((e,t)=>{let a=0;return i(t)&&(a=Number(t?.quantity)),e+a},0)/Number(r?.contract_data?.pair_total);o.value=r?.contract_data?.is_locked||((r?.contract_data?.pair_holders_rank?.some?.(e=>i(e))&&c>.001)??!1),s.value=(r?.contract_data?.risk_score??0)/100||0;const d={...r?.contract_data,...r,audits_info:l,owner_txs:u};e.value=d})}}}),qe=F("rankKline",()=>{const e=t({}),o=t(null),r=t(null),n=N([]),l=t(!1),i=t(""),u=t(""),c=t(0),d=t(0),m=t(0),p=t(!1),v=t(!1),_=M(),h=A(),{t:b}=a(),f=N(0),k=s(()=>f.value||y.value?.current_price_usd),g=s(()=>h.evmAddress||_.address),y=s(()=>o.value?.token),x=s(()=>o.value?.pairs?.[0]),w=s(()=>0==c.value?b("defaultGroup"):n.value?.find(e=>e.group_id==c.value)?.name),$=s(()=>x.value?.pair),C=s(()=>{const e=new T(y.value?.total||0).minus(y.value?.lock_amount_dec||0).minus(y.value?.other_amount_dec||0).minus(y.value?.burn_amount_dec||0);return e.lt(0)?new T(0):e}),S=s(()=>new T(k.value||0).times(C.value||0).toFixed()||"0");return{klineRow:e,tokenInfo:o,tokenInfoExtra:r,userFavoriteGroups:n,collected:l,remark:i,remark2:u,groupId:c,selectedGroup:m,token:y,pair:x,twitterType:d,currentGroup:w,editableGroup:p,editableRemark:v,pairAddress:$,tokenPrice:f,price:k,circulation:C,marketCap:S,getData:function(e){const t=e.id;D(t).then(e=>{o.value=e}),I(t).then(e=>{r.value=e}),function(e){B(e).then(e=>{d.value=e.type||0}).catch(()=>{d.value=0})}(t),g.value&&(function(e){R(e,g.value).then(e=>{l.value=!!e?.address,i.value=e?.remark||"",u.value=e?.remark||"",c.value=e?.group_id||0,m.value=e?.group_id||0}).catch(e=>{}).finally(()=>{})}(t),async function(){try{const e=await E(g.value);n.value=(e||[]).filter(e=>!!e.name&&"token"===e.type)}catch(e){}}()),Ve().getContractCheckResult(t,g.value)}}});function ze(){const{t:e}=a(),t=Y(),o=L(),r=A(),n=s(()=>(r.accessToken?[{id:"trade",name:e("mine")}]:[]).concat(t.totalHolders?.filter?.(e=>(e?.total_address||0)>0&&["16","19","25","30","31"]?.includes(e.type))?.map?.(e=>({id:e.type,name:e?.[O(o.locale)]+("31"!==e.type?`(${e?.total_address})`:"")})))),l=H("tv_markTabsChecked",{trade:!0,16:!1,19:!1,25:!0,30:!1,31:!0});const i=new Map,u=new Map;function c({el:e,side:t,type:a,urlPrefix:s,name:o,bucketTime:r}){const n="buy"===t,l="31"===a;let i=n?`${s}signals/marks/mark-buy-${a}.png`:`${s}signals/marks/mark-sell-${a}.png`;e.wallet_logo?.logo&&e.wallet_logo.logo.includes(".webp")&&(i=e.wallet_logo.logo);let u="transparent",c=0;return l&&(c=2,u=n?"#12B886":"#F6465D"),{id:`${e.tx_time}-${t}-${a}`,time:r,color:{background:"transparent",border:u},imageUrl:i,label:n?"B":"S",labelFontColor:"#fff",minSize:Number(e.volume)>=2e3?30:25,hoveredBorderWidth:c,borderWidth:c,text:d(o,a,e,n,r),showLabelWhenImageLoaded:!1,user_address:e.wallet_address,tx_time:e.tx_time}}function d(t,a,s,o,r){const n=e(o?"bought":"sold"),l=t?.replace(/\(.*\)$/,"");if(30===Number(a)){const t=e(o?"netInflow":"netOutflow"),a=e(o?"inflow":"outflow"),n=e(o?"campaignBuyAvg":"campaignSellAvg");return`${l} ${t}\n        ${a}: ${z(s.volume,2)}(${z(s.txns,0)})\n        ${n}: $${z(Number(s.volume)/(Number(s.amount)||1),4)}\n        ${t}: ${z(s.volume,2)}\n        ${U(r,"YYYY-MM-DD HH:mm")}\n      `}return`${s.wallet_logo?.name||`${l}`} ${n}\n        ${e("amountB")}: ${z(s.amount,2)}\n        ${e("amountU")}: $${z(s.volume,2)}\n        ${e("price")}: $${z(Number(s.volume)/(Number(s.amount)||1),4)}\n        ${e("Txs")}: ${z(s.txns)}\n        ${U(r,"YYYY-MM-DD HH:mm")}\n        `}function m(e,t,a,s){const o=[],r={},n=q().globalConfig?.token_logo_url||"https://www.iconaves.com/",l=Number(t);for(const i of e){const e=Math.floor(i.time/l)*l;if(30===Number(a)){const t=i?.buy?.volume||0,a=i?.sell?.volume||0,s=`${e}-${t>a?"buy":"sell"}`,o=r[s]??={time:e,side:t>a?"buy":"sell",amount:0,txns:0,volume:0,buyAmount:0,sellAmount:0,buyTxns:0};o.buyAmount=i?.buy?.amount||0,o.sellAmount=i?.sell?.amount||0,o.amount=Math.abs(o.buyAmount-o.sellAmount),o.buyTxns=i?.buy?.txns||0,o.sellTxns=i?.sell?.txns||0,o.txns=o.buyTxns+o.sellTxns,o.volume=Math.abs(t-a),o.buyVolume=i?.buy?.volume||0,o.sellVolume=i?.sell?.volume||0}else{if(i.buy){const t=`${e}-buy`,a=r[t]??={time:e,side:"buy",amount:0,txns:0,volume:0};a.amount+=i.buy.amount,a.txns+=i.buy.txns,a.volume+=i.buy.volume}if(i.sell){const t=`${e}-sell`,a=r[t]??={time:e,side:"sell",amount:0,txns:0,volume:0};a.amount+=i.sell.amount,a.txns+=i.sell.txns,a.volume+=i.sell.volume}}}for(const i of Object.values(r)){const e="buy"===i.side;o.push({id:`${i.time}-${i.side}-${a}`,time:i.time,color:{background:"transparent",border:"transparent"},imageUrl:e?`${n}signals/marks/mark-buy-${a}.png`:`${n}signals/marks/mark-sell-${a}.png`,label:e?"B":"S",labelFontColor:"#fff",minSize:20,hoveredBorderWidth:0,borderWidth:0,text:p(i,a,s),showLabelWhenImageLoaded:!1})}return o.sort((e,t)=>e.time-t.time)}function p(t,a,s){const o="buy"===t.side;if(30===Number(a)){const a=e(o?"netInflow":"netOutflow"),{buyVolume:r,sellVolume:n,buyTxns:l,sellTxns:i,volume:u}=t,c=(r||0)>0?`\n${e("inflow")}: ${z(r||0,2)}(${z(l||0,0)})\n${e("campaignBuyAvg")}: $${z((r||0)/(t.buyAmount||1),2)}`:"",d=(n||0)>0?`\n${e("outflow")}: $${z(n||0,4)}(${z(i||0,0)})\n${e("campaignSellAvg")}: $${z((n||0)/(t.sellAmount||1),2)}`:"";return`${s?.replace(/\(.*\)$/,"")} ${a}${c}${d}\n${e(o?"netInflow":"netOutflow")}: ${z(u,2)}\n${U(t.time,"YYYY-MM-DD HH:mm")}\n`}const r=e(o?"bought":"sold"),{amount:n,txns:l,volume:i}=t;return`${s?.replace(/\(.*\)$/,"")} ${r}\n${e("amountB")}: ${z(n,2)}\n${e("amountU")}: $${z(i,2)}\n${e("price")}: $${z(i/(n||1),4)}\n${e("Txs")}: ${z(l)}\n${U(t.time,"YYYY-MM-DD HH:mm")}\n`}return W(()=>t.token?.token,()=>{i.clear(),u.clear()}),{marksTabs:n,markTabsChecked:l,createMarkButton:function(e,t){const a=e?.createButton();a&&(n.value?.forEach(t=>{const s=document.createElement("button");s.style.display="flex",s.style.alignItems="center",s.style.cursor="pointer",s.style.backgroundColor="transparent",s.style.border="none",s.style.outline="none",s.style.fontSize="12px",l.value?.[t?.id]&&(s.style.color="#3F80F7"),s.innerText=t.name,a.appendChild(s),s.onclick=()=>{l.value[t.id]?(l.value[t.id]=!1,s.style.color="inherit",e?.activeChart?.()?.clearMarks?.()):(l.value[t.id]=!0,s.style.color="#3F80F7"),e?.activeChart?.()?.refreshMarks?.()}}),t.push(a))},getMarks:function({from:e,to:t,interval:a,onDataCallback:s,pair:o,chain:r,token:d,user:p}){n.value.forEach(n=>{const v=o+"-"+r+"-"+p+"-"+a+"-"+n.id+"-"+e+"-"+t;if(i.has(v)&&l.value?.[n.id]){const e=m(i.get(v)||[],a,n.id,n.name);return void s(e||[])}if(u.has(v)&&l.value?.[n.id]){const e=u.get(v);return void s(e)}"trade"===n.id&&l.value?.[n.id]?G({from:e,to:t,interval:a,pair:o+"-"+r,token_address:d,user_address:p}).then(e=>{const t=m(e,a,n.id,n.name);i.set(v,e||[]),s(t||[])}):l.value?.[n.id]&&V({from:e,to:t,interval:a,pair_id:o+"-"+r,type:n.id}).then(e=>{if(Array.isArray(e)){const t=function(e,t,a,s){const o=[],r=q().globalConfig?.token_logo_url||"https://www.iconaves.com/",n=Number(t);for(const l of e){const e=Math.floor(l.time/n)*n;for(const t of l.holders){const{wallet_address:n,wallet_logo:l}=t;t.buy&&o.push(c({el:{...t.buy,wallet_address:n,wallet_logo:l},side:"buy",type:a,name:s,bucketTime:e,urlPrefix:r})),t.sell&&o.push(c({el:{...t.sell,wallet_address:n,wallet_logo:l},side:"sell",type:a,name:s,bucketTime:e,urlPrefix:r}))}}return o}(e||[],a,n.id,n.name);u.set(v,t),s(t||[])}})})},wsTxUpdateMarks:function({tx:e,interval:a,user:s},o){const r=t?.token?.token,n=t?.token?.chain,l=t?.pairAddress,u={time:e.time};if("maker"in e){if(r!==e.target||e.maker!==s)return;const t=e.direction;"buy"===t&&(u.buy={amount:Number(e?.target_amt||0),txns:1,volume:Number(e?.price_u||0)*Number(e?.target_amt||0)}),"sell"===t&&(u.sell={amount:Number(e?.target_amt||0),txns:1,volume:Number(e?.price_u||0)*Number(e?.target_amt||0)})}else{if(r!==e.from_address&&r!==e.to_address||e.wallet_address!==s)return;const a=t?.token?.token===e.to_address?"buy":"sell";e.time,"buy"===a&&(Number(e?.to_amount||0),Number(e?.to_price_usd||0),Number(e?.to_amount||0)),"sell"===a&&(Number(e?.from_amount||0),Number(e?.from_price_usd||0),Number(e?.from_amount||0))}i.forEach((e,t)=>{t.startsWith(l+"-"+n+"-"+s+"-"+a+"-trade")&&e.push(u)}),o?.activeChart?.()?.refreshMarks?.()},profilingMarksCache:u}}const Ue={key:0,class:"time"},je={key:0,class:"text-center"},Ke={class:"color-[--d-F5F5F5-l-111] text-14px mb-12px block"},Je={class:"color-[--d-F5F5F5-l-111] text-28px flex items-center"},Xe={class:"bg-[--d-151A22-l-E8F1FF] px-16px py-8px radius-8px mr-6px text-center"},Qe={class:""},Ze={class:"bg-[--d-151A22-l-E8F1FF] px-16px py-8px radius-8px mr-6px text-center"},et={class:"bg-[--d-151A22-l-E8F1FF] px-16px py-8px radius-8px mr-6px text-center"},tt={class:"bg-[--d-151A22-l-E8F1FF] px-16px py-8px radius-8px mr-6px text-center"},at={key:1,class:"flex items-center bg-[--d-151A22-l-E8F1FF] py-8px px-24px radius-4px"},st={class:"color-[--d-8CA0C3-l-566275] text-36px"},ot=j({__name:"unknownRisk",props:{isRank:{type:Boolean,default:!1}},emits:["refresh"],setup(e,{emit:t}){const a=t,o=e.isRank?qe():Y(),l=s(()=>o.price),d=s(()=>o.token?.opening_at||0);function v(){a("refresh")}return(e,t)=>{const a=K;return i(l)?p("",!0):(n(),m("div",Ue,[i(d)>0?(n(),m("div",je,[c("span",Ke,w(e.$t("countdown2Opening")),1),(n(),r(a,{key:i(d),timestamp:i(d),"end-time":0,onDone:v},{default:u(({formattedData:e})=>[c("div",Je,[c("div",Xe,[c("span",Qe,w((e.days<10?"0":"")+e.days),1),t[0]||(t[0]=c("span",{class:"text-12px mt-4px color-[--d-8CA0C3-l-566275] block"},"D",-1))]),c("div",Ze,[c("span",null,w((e.hours<10?"0":"")+e.hours),1),t[1]||(t[1]=c("span",{class:"text-12px mt-4px color-[--d-8CA0C3-l-566275] block"},"H",-1))]),c("div",et,[c("span",null,w((e.minutes<10?"0":"")+e.minutes),1),t[2]||(t[2]=c("span",{class:"text-12px mt-4px color-[--d-8CA0C3-l-566275] block"},"M",-1))]),c("div",tt,[c("span",null,w((e.seconds<10?"0":"")+e.seconds),1),t[3]||(t[3]=c("span",{class:"text-12px mt-4px color-[--d-8CA0C3-l-566275] block"},"S",-1))])])]),_:1},8,["timestamp"]))])):(n(),m("div",at,[c("span",st,w(e.$t("unknownRisk")),1)]))]))}}},[["__scopeId","data-v-64d3a44b"]]),rt={id:"tv_chart_container",ref:"kline",style:{width:"100%",height:"100%"}},nt=j(e({__name:"index",props:{isRank:{type:Boolean}},emits:["refresh"],setup(e,{emit:a}){const o=e,r=J(X.KLINE_DATE_FILTER),l=o.isRank?qe():Y(),u=A(),b=Q(),f=Z(),k=ee(),g=s(()=>o.isRank&&"klineRow"in l?l.klineRow?.id:k.params.id),y=t(""),x=t(!1);let w=!1,$=!1;const C=s(()=>te(g.value)?.chain||l?.token?.chain||""),S=s(()=>te(g.value)?.address||l?.token?.token),P=s(()=>u.userInfo?.addresses?.find?.(e=>e.chain===C.value)?.address||u?.userInfo?.evmAddress),F=s(()=>l?.token?.symbol||"-"),M=s(()=>l?.pairAddress),D=s(()=>l?.pair?.amm||"");let I=!1;W(()=>g.value,e=>{e&&j?.activeChart()&&j?.activeChart()?.removeAllShapes?.()}),W(M,e=>{e!==y.value&&function(){w=!1,it(),ct();const e=M.value;if(x.value&&"token-id"===k.name){const t=C.value&&oe.includes(C.value)||!1;V.value=re(V.value,C.value,t),j?(j?.resetCache?.(),j?.activeChart?.()?.clearMarks?.(),j?.setSymbol?.(F.value+"---"+g.value+e,V.value,()=>{w=!0})):Qe()}}()}),W(P,()=>{x.value&&"token-id"===k.name&&(j?.activeChart?.()?.clearMarks?.(),j?.activeChart?.()?.refreshMarks?.())});const B=ne(),E=L();let R=null,O=0;const G=new Map,V=N(localStorage.getItem("tv_resolution")||"15"),U=le();let j=null;const K=H("tv_showMarket",!1);function Ye(){w=!1,$=!1,R=null,O=0,it(),ct(),j?.remove?.(),Qe()}W(()=>U.theme,e=>{j&&j?.changeTheme(e).then(()=>{dt(),j?.applyOverrides?.({"scalesProperties.textColor":U.isDark?"#d5d5d5":"#333","paneProperties.backgroundType":"solid","paneProperties.background":fe("--secondary-bg")})})}),W(()=>E.locale,()=>{Ye()});let Le=[];function Oe(){$&&(Le.forEach(e=>{j?.removeButton?.(e)}),Le=[],function(){const e=j?.createButton();if(!e)return;const t=()=>{const t=K.value;e.innerHTML=`\n        <span style="font-size: 12px; cursor: pointer;">\n          ${t?'Price / <span style="color:#286DFF">MCap</span>':'<span style="color:#286DFF">Price</span> / MCap'}\n        </span>`};e.onclick=()=>{K.value=!K.value,t(),j?.resetCache?.(),j?.activeChart?.().resetData?.()},t(),Le.push(e)}(),He(j,Le))}const{createMarkButton:He,getMarks:We,marksTabs:Ge,wsTxUpdateMarks:Ve,profilingMarksCache:Ue}=ze();W(Ge,()=>{Ke()});let je=0;function Ke(){if(x.value)je=0,Oe();else{if(je>3)return;setTimeout(()=>{je++,Ke()},500)}}let Je=!1,Xe=0;async function Qe(){const e=F.value?.toUpperCase?.()||"-",t=C.value&&oe.includes(C.value)||!1;V.value=re(V.value,C.value,t);const a=q().globalConfig?.token_logo_url||"https://www.iconaves.com/",s=await ie();j=new s({symbol:e.replace("<","＜")||" ",debug:!1,width:"100%",height:"100%",interval:V.value,theme:U.theme,container:"tv_chart_container",library_path:`${a}charting_library-29.4.0/charting_library/`,locale:ce(E.locale),disabled_features:["header_symbol_search","header_screenshot","header_compare","volume_force_overlay","header_undo_redo","header_settings","header_saveload","timeframes_toolbar"],enabled_features:["request_only_visible_range_on_reset",...t?["seconds_resolution"]:[]],charts_storage_url:location.host,charts_storage_api_version:"1.1",timezone:ue(),time_frames:[],loading_screen:{backgroundColor:U.isDark?"#0B0D12":"#F6F9FF",foregroundColor:"#3F80F7"},custom_css_url:`${location.origin}/tv_custom_1.css`,custom_formatters:{priceFormatterFactory:()=>({format:e=>K.value?z(e,{decimals:2,locale:"en"}):String(z(e,{decimals:4,limit:6,locale:"en"}))})},overrides:{volumePaneSize:"small","paneProperties.topMargin":"10","scalesProperties.textColor":U.isDark?"#d5d5d5":"#333","paneProperties.backgroundType":"solid","paneProperties.background":U.isDark?"#0B0D12":"#F6F9FF","paneProperties.vertGridProperties.style":2,"paneProperties.legendProperties.showLegend":!1,"paneProperties.legendProperties.showStudyArguments":!0,"paneProperties.legendProperties.showStudyTitles":!0,"paneProperties.legendProperties.showStudyValues":!0,"paneProperties.legendProperties.showSeriesTitle":!0,"paneProperties.legendProperties.showSeriesOHLC":!0,"mainSeriesProperties.candleStyle.drawWick":!0,"mainSeriesProperties.candleStyle.drawBorder":!0,"mainSeriesProperties.candleStyle.barColorsOnPrevClose":!1,"mainSeriesProperties.hollowCandleStyle.drawWick":!0,"mainSeriesProperties.hollowCandleStyle.drawBorder":!0,"mainSeriesProperties.haStyle.drawWick":!0,"mainSeriesProperties.haStyle.drawBorder":!0,"mainSeriesProperties.haStyle.barColorsOnPrevClose":!1,"mainSeriesProperties.barStyle.barColorsOnPrevClose":!1,"mainSeriesProperties.barStyle.dontDrawOpen":!1,"mainSeriesProperties.lineStyle.linewidth":2,"mainSeriesProperties.lineStyle.priceSource":"close","mainSeriesProperties.areaStyle.linewidth":2,"mainSeriesProperties.areaStyle.priceSource":"close"},datafeed:{onReady:e=>{const t=C.value&&oe.includes(C.value),a={supported_resolutions:["1S","1","5","15","30","60","120","240","1D","1W"],supports_marks:!0,supports_timescale_marks:!0,supports_time:!0};t||(a.supported_resolutions=["1","5","15","30","60","120","240","1D","1W"]),dt(),setTimeout(()=>e(a),50)},resolveSymbol:(e,t,a)=>{try{const e=!(!C.value||!oe?.includes?.(C.value)),a=F.value?.toUpperCase?.()||l?.token?.symbol||"-",s=Number(l?.price)||0,o={name:a,ticker:a,description:a?.split?.("---")?.[0]||"",exchange:"Ave.ai",timezone:ue(),format:K.value?"volume":"price",minmov:1,minmove2:0,pricescale:s>0?10**_e(s).precision:1e10,volume_precision:2,fractional:!1,session:"24x7",has_intraday:!0,intraday_multipliers:["1","5","15","30","60","120","240"],has_seconds:e,seconds_multipliers:["1","5","15","30"],has_daily:!0,has_weekly_and_monthly:!0,supported_resolutions:["1S","1","5","15","30","60","120","240","1D","1W"],data_status:"streaming",visible_plots_set:"ohlcv",type:"crypto",listed_exchange:ve?.(C.value||"",D.value)?.show_name||""};e||(o.supported_resolutions=["1","5","15","30","60","120","240","1D","1W"],o.seconds_multipliers=[]),setTimeout(()=>t(o),0)}catch(s){a(s?.toString?.()||"resolveSymbol err")}},getBars:(e,t,a,s,o)=>{const{from:r,to:n,firstDataRequest:i}=a;try{if(i)Je=!1,R=null,O=0;else if(Je)return void s([],{noData:!0});const e={interval:de(t),pair_id:M.value+"-"+C.value,token_id:M.value?void 0:g.value,from:r,to:i?0:Math.max(n,Xe||0)};I=!0,me(e).then(e=>{const t=e?.kline_data||[],a=t?.map?.(e=>({time:1e3*e.time,open:K.value?new T(e.open||0).times(l?.circulation||0).toNumber():e.open,high:K.value?new T(e.high||0).times(l?.circulation||0).toNumber():e.high,low:K.value?new T(e.low||0).times(l?.circulation||0).toNumber():e.low,close:K.value?new T(e.close||0).times(l?.circulation||0).toNumber():e.close,volume:e.volume}))||[];y.value=e?.pair||"",i&&(R=t?.[t?.length-1]||null,O=Number(R?.close||0),R&&(R.time=1e3*R.time),Je=a?.length<100),t?.length>0&&(Xe=t?.[0]?.time||0),s(a,{noData:!a?.length}),setTimeout(()=>{pe("klineDataReady").emit()},10)}).finally(()=>{I=!1})}catch(u){o(u?.toString?.()||"getBars err")}},subscribeBars:(e,t,a,s)=>{if(G.has(g.value))return void et(t,a);const{address:o,chain:r}=te(g.value);let n=["multi_tx",o,r];Ie.includes(r)&&(n=["simple_tx",{tks:[{ch:r,tk:o}],rt:"json"}]);const l={jsonrpc:"2.0",method:"subscribe",params:n,id:1};et(t,a,B.send(l)),G.set(g.value,l)},unsubscribeBars:e=>{if(e){const e=G.get(g.value)||{};if(e?.params?.[1]===S.value)return;G.forEach(e=>{e?.params?.[1]!==S.value&&B.send({...e,method:"unsubscribe"})}),G?.clear()}},searchSymbols:(e,t,a,s)=>{},getMarks:(e,t,a,s,o)=>{const r=de(o);We({from:t,to:a,interval:r,pair:M.value,token:g.value,chain:C.value||"",user:P.value,onDataCallback:s})}}}),he(),j.onChartReady(()=>{x.value=!0,w=!0,U.isDark?j?.applyOverrides?.({"scalesProperties.textColor":"#d5d5d5"}):j?.applyOverrides?.({"scalesProperties.textColor":"#333"}),j?.activeChart?.()?.onIntervalChanged().subscribe(null,e=>{V.value!==e&&(V.value=e,localStorage.setItem("tv_resolution",e),j?.resetCache?.())}),be(j),ut(),function(){if(j?.activeChart){let e=JSON.parse(localStorage?.[De]||"[]");e=e.filter((t,a)=>e.findIndex(e=>e.name===t.name)===a),e.forEach(e=>{j?.activeChart?.().createStudy(e.name,!1,!1)})}}(),j?.applyOverrides?.({"scalesProperties.textColor":U.isDark?"#d5d5d5":"#333","paneProperties.backgroundType":"solid","paneProperties.background":fe("--secondary-bg")})}),j?.headerReady().then(()=>{$=!0,Oe()}),j?.subscribe("onMarkClick",e=>{const{token:t,symbol:a,logo_url:s,chain:o}=l.tokenInfo?.token||{},{target_token:r,token0_address:n,token0_symbol:i,token1_symbol:u,pair:c}=l.pair||{};let d=P.value;for(const[,l]of Ue){const t=l.find(t=>t.id===e)?.user_address;if(t){d=t;break}}const m={drawerVisible:!0,tokenInfo:{id:k.params.id,symbol:a,logo_url:s,chain:o,address:t},pairInfo:{target_token:r,token0_address:n,token0_symbol:i,token1_symbol:u,pairAddress:c},user_address:d};b.$patch(m)});let o=0;j.subscribe("mouse_down",()=>{o=performance.now()}),j.subscribe("mouse_up",e=>{if(performance.now()-o>=200)return;const t=j?.activeChart().getTimeScale().coordinateToTime(e.clientX-56);if(t&&V.value){const e=ke[V.value]||{val:V.value,unit:"m"},a=ge(1e3*t).add(e.val,e.unit).unix();f.isClickKlineFilter&&r?.value&&(r.value=[String(t),String(a)])}}),j?.subscribe("study_event",(e,t)=>{"create"!==t&&"remove"!==t||Ze||function(){if(j?.activeChart){let e=j?.activeChart?.().getAllStudies()||[];e=e.filter((t,a)=>e.findIndex(e=>e.name===t.name)===a),localStorage.setItem(De,JSON.stringify(e.filter(e=>"Volume"!==e.name)))}}()}),window.onbeforeunload=()=>{Ze=!0}}let Ze=!1;function et(e,t,a=B.getWSInstance()){a?.onmessage(a=>{const s=ye(a);if(!s)return;const{event:o,data:r}=s;if(o===xe.SIMPLE_TX||o===xe.TX){const a=r?.msg||r?.tx,s=de(e),o=te(g.value)?.address;let n="";if(n="target"in a?a.target:[a.from_address,a.to_address].find(e=>e===o)||"",n===o&&!I){const e="pair"in a?a.pair:a.pair_address,r="price_u"in a?Number(a.price_u||0):Number(a.from_address?.toLowerCase?.()===l.token?.token?.toLowerCase?.()?a.from_price_usd:a.to_price_usd)||0;if(e===M.value&&(O=r),e!==M.value){const e=r;if(!O&&Math.abs(e-O)>.35*O)return}l.tokenPrice=r;const n=we(a,o,R,s);n&&(R={...n});const i={...n};K.value&&i&&(i.open=new T(i.open||0).times(l?.circulation||0).toNumber(),i.high=new T(i.high||0).times(l?.circulation||0).toNumber(),i.low=new T(i.low||0).times(l?.circulation||0).toNumber(),i.close=new T(i.close||0).times(l?.circulation||0).toNumber()),i&&i?.time&&t(i)}Ve({tx:a,interval:Number(s),user:P.value},j)}},"kline")}let tt=!1;const at=$e("kHeight",Ce.KLINE),st=Ee().height,nt=Se("kline");function lt(e){let t=e.clientY;if(tt=!0,!nt)return;const{height:a}=Be(nt);return at.value=a.value,document.onmousemove=e=>{if(!tt)return;if(e.clientY>st.value)return void(tt=!1);document.getElementById("tv_chart_container").style.pointerEvents="none";const a=e.clientY<t?at.value-(t-e.clientY):at.value+e.clientY-t;a<=st.value-164&&(at.value=a),t=e.clientY},document.onmouseup=()=>{document.getElementById("tv_chart_container").style.pointerEvents="auto",tt=!1,document.onmousemove=null,document.onmouseup=null,l.centerTopHeight=at.value},!1}const{resetLimitPriceLineId:it,subscribePriceMove:ut}=ae(()=>j,()=>w,K),{resetAvgPriceLineId:ct}=se(()=>j,()=>w,K);function dt(){const e=document.querySelector("#tv_chart_container iframe"),t=e?.contentWindow?.document.documentElement;t&&t.style.setProperty("--secondary-bg",fe("--secondary-bg"))}Pe(()=>j,()=>w,K),Fe(()=>{Ze=!0}),Ne(()=>{Qe(),Re(()=>{j?.resetCache?.(),j?.activeChart?.().resetData?.()})});const mt=a;function pt(){mt("refresh"),Ye()}return(t,a)=>(n(),m(_,null,[c("div",{class:"relative",style:Me({height:`${e.isRank?390:i(at)}px`})},[c("div",rt,null,512),Ae(v(ot,{isRank:e.isRank,onRefresh:pt},null,8,["isRank"]),[[Te,i(x)]])],4),e.isRank?p("",!0):(n(),m("div",{key:0,class:"w-full cursor-row-resize bg-[--border] gap-1px hover:bg-[--third-text] flex items-center justify-center h-4px",onMousedown:d(lt,["stop","prevent"])},[(n(),m(_,null,h(4,e=>c("span",{key:e,class:"bg-[--icon-color] w-2px h-2px rounded-full"})),64))],32))],64))}}),[["__scopeId","data-v-e4dc5ddd"]]);export{nt as K,Le as _,Ve as a,We as b,Oe as c,He as d,Ge as g,qe as u};
